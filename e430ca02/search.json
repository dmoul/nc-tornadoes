[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Five decades of tornadoes in North Carolina",
    "section": "",
    "text": "NOAA National Centers for Environmental Information1 make Tornado event data available for download from their Storm Events Database2. Tornado event data is available from 1950 to the present. Specifically for this project, I downloaded 53+ years of North Carolina data3 (1970-01-01 through 2023-04-30), which was the most current available when I downloaded it on 2023-08-11. The data comes from NOAA’s National Weather Service (NWS).\nThe data set includes 1,430 tornado events (one record per event). Multiple events may be associated with one tornado, and multiple tornadoes can occur in one episode. When plotting tracks I filtered out records that lacked beginning or ending coordinates as well as one record with obviously bad data, leaving me with 1,097 (77%) tracks to work with. All missing coordinates are in records of tornadoes prior to 2005. Plots and models not requiring coordinates or distances or relationships derived from them use the full set of 1,428 events.\nThe method for counting tornadoes is summarized on Storm Data FAQ Page4\nSince it’s non-trivial to determine from the data which segments are continuations of the same tornado (see Section 5.2.2), the counts, plots and models in this analysis are of tornado segments rather than tornadoes. Event and segment are synonymous.\nData generating processes have a profound effect on the data they leave behind. Over these 50+ years undoubtedly there were many changes in NWS instruments, policies, budgets, and staffing.\nFor example, the accuracy of track data improved over the years as noted on the Storm Data FAQ Page. See How accurate are the latitude and longitude locations?.\nAnother example5 of improved tools:\nWe can infer some of the changes from patterns in the data. See for example Section 4.1 Changes in detection over time."
  },
  {
    "objectID": "index.html#acknowledgements",
    "href": "index.html#acknowledgements",
    "title": "Five decades of tornadoes in North Carolina",
    "section": "Acknowledgements",
    "text": "Acknowledgements\nThanks to the people of the US National Weather Service and NOAA National Centers for Environmental Information for making this data so easily accessible.\nThe image above is from the National Weather Service’s page EF-3 Tornado Hits Beaufort County April 25, 2014 (image courtesy WNCT). The related narratives are below.\n\n\nShow the code\ndta_non_mapping |>\n  filter(event_id == \"505635\") |>\n  mutate(event = paste0(\"Event ID \", event_id, \": \", event_narrative),\n         episode = paste0(\"Episode ID \", episode_id, \": \", episode_narrative)\n         ) |>\n  select(begin_datetime, event, episode) |>\n  gt()\n\n\n\n\n\n\nTable 1:  National Weather Service event and episode narratives \n  \n    \n    \n      begin_datetime\n      event\n      episode\n    \n  \n  \n    2014-04-25 18:35:00\nEvent ID 505635: The tornado touched down approximately 1.5 miles west of Chocowinity along Taylor Road causing EF0 damage to trees and mobile homes. The tornado then strengthened to a strong EF2 as it impacted many homes and businesses from the intersection of U.S. Highway 17 and North Carolina Highway 33 eastward for about 1 mile. Several homes had significant damage in this area with numerous trees snapped.  The tornado reached EF3 intensity with winds estimated at 150 mph as it impacted homes along Whichards Beach Road from near Warrens Way to Harbor Drive. Many homes in this area were severely damaged or destroyed. Numerous vehicles and boats were damaged or destroyed.  The tornado then moved into the Washington Park area near Shorewood Drive and Daniels Drive after crossing the Pamlico River. Strong EF2 damage continued for about five miles as the tornado tracked eastward across U.S. Highway 264 to just north of the intersection of North Carolina Highway 32. Extensive damage occurred to numerous homes with some completely destroyed. The tornado continue to track east of North Carolina Highway 32 and north of U.S. Highway 264 for about 10 miles producing mainly EF0 to EF1 damage. The tornado finally dissipated near the Terra Ceia farms area.  There was one indirect fatality and 16 injuries associated with this tornado. It is estimated 150 to 200 homes and structures were damaged with many destroyed.\nEpisode ID 83752: A cold front approached eastern North Carolina during the afternoon of April 25th 2014. Warm southerly winds ahead of the front produced good instability over the region and numerous showers and thunderstorms crossed during the afternoon and evening. Two super-cell thunderstorms produced the bulk of the severe weather with multiple tornadoes reported in parts of Greene, Pitt and Beaufort counties. There was one indirect fatality as and elderly woman located near Washington died from pneumonia as a result of injuries sustained during the tornado. Total dollar damage was estimated at 15 million dollars."
  },
  {
    "objectID": "tornadoes.html#number-by-decade",
    "href": "tornadoes.html#number-by-decade",
    "title": "1  Tornadoes",
    "section": "1.1 Number by decade",
    "text": "1.1 Number by decade\nWhile tornadoes can occur at any time of the year, they are more common in spring and early autumn (the latter being hurricane season). As seen in Figure 1.2 there were noticeably fewer tornado segments recorded in the 1970s and 1980s (panel A). Beginning in the mid-1990s the NWS made major improvements in counting them (panel D).\n\n\nShow the code\ndata_for_plot <- dta_non_mapping |>\n  arrange(decade, day_of_year) |>\n  select(event_id, episode_id, begin_datetime, day_of_year, year, decade) |>\n  mutate(month = month(begin_datetime, label = TRUE, abbr = TRUE),\n         tmp = 1)\n\np1 <- data_for_plot |>\n  reframe(n_segments = sum(tmp),\n         .by = c(decade, month)\n         ) |>\n  mutate(n_cum = cumsum(n_segments),\n         .by = decade) |>\n  ggplot() +\n  geom_line(aes(`month`, n_cum, color = decade, group = decade),\n            alpha = 0.8,\n            show.legend = FALSE) +\n  scale_color_viridis_d(end = 0.85) +\n  theme(panel.border = element_blank(),\n        panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        # legend.position = c(0.75, 0.2)\n        ) +\n  guides(color = guide_legend(override.aes = list(linewidth = 3))) +\n  labs(\n    subtitle = \"Monthly count by decade\",\n    x = NULL,\n    tag = \"A\"\n  )\n\np2 <- data_for_plot |>\n  reframe(n_segments = sum(tmp),\n         .by = c(decade, year, month)\n         ) |>\n  mutate(n_cum = cumsum(n_segments),\n         .by = year) |>\n  ggplot() +\n  geom_line(aes(month, n_cum, color = decade, group = year),\n            alpha = 0.7, linewidth = 0.5,\n            show.legend = FALSE) +\n  scale_color_viridis_d(end = 0.85) +\n  theme(panel.border = element_blank(),\n        panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        # legend.position = c(0.75, 0.2)\n        ) +\n  guides(color = guide_legend(override.aes = list(linewidth = 3))) +\n  labs(\n    subtitle = \"Monthly count by year\",\n    x = NULL,\n    y = NULL,\n    tag = \"B\"\n  )\n\np3 <- data_for_plot |>\n  reframe(n_segments = sum(tmp),\n         .by = c(decade, year, day_of_year)\n         ) |>\n  mutate(n_cum = cumsum(n_segments),\n         .by = year) |>\n  ggplot() +\n  geom_line(aes(day_of_year, n_cum, color = decade, group = year),\n            alpha = 0.7, linewidth = 0.5,\n            show.legend = TRUE) +\n  scale_color_viridis_d(end = 0.85) +\n  theme(panel.border = element_blank(),\n        panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        # legend.position = c(0.75, 0.2)\n        ) +\n  guides(color = guide_legend(override.aes = list(linewidth = 3))) +\n  labs(\n    subtitle = \"Daily count by year\",\n    y = NULL,\n    tag = \"C\",\n    color = \"Decade\"\n  )\n\np4 <- data_for_plot |>\n  reframe(n_segments = sum(tmp),\n         .by = c(decade, year, day_of_year)\n         ) |>\n  mutate(n_cum = cumsum(n_segments),\n         .by = year) |>\n  mutate(year = year - floor(year / 10) * 10) |>\n  ggplot() +\n  geom_line(aes(day_of_year, n_cum, color = year, group = year),\n            alpha = 0.7, linewidth = 0.5,\n            show.legend = TRUE) +\n  scale_color_viridis_c(end = 0.85,\n                        breaks = c(0, 2, 4, 6, 8)) +\n  facet_wrap(~decade) +\n  theme(panel.border = element_blank(),\n        panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        #legend.position = c(0.75, 0.2)\n        ) +\n  labs(\n    subtitle = \"Daily count by year\",\n    tag = \"D\",\n    color = \"Decadal\\nyear\"\n  )\n\n\n(p1 + p2 + p3 + plot_layout(guides = \"collect\")) / p4 +\n  plot_layout(heights = c(1, 2)) +\n  plot_annotation(title = \"NC tornado segment track cumulative counts\",\n                  subtitle = \"1970-01-01 to 2023-04-30\",\n                  caption = my_caption,\n                  theme = theme(plot.title = element_text(size = rel(2.0), face = \"bold\"))\n  )\n\n\n\n\n\nFigure 1.2: NC tornado segment track cumulative counts"
  },
  {
    "objectID": "tornadoes.html#track-bearing",
    "href": "tornadoes.html#track-bearing",
    "title": "1  Tornadoes",
    "section": "1.2 Track bearing",
    "text": "1.2 Track bearing\nMost tracks in North Carolina follow the prevailing winds moving from the SW to the NE, especially east of the Appalachian mountains. Figure 1.3 plots the bearing and length of each segment with non-zero length.\n\n\nShow the code\ndata_for_plot <- dta |>\n  st_drop_geometry() |>\n  mutate(length_mi = as.numeric(length_mi)) |>\n  filter(length_mi > 0)\n\ndata_for_plot |>\n  ggplot() +\n  geom_point(aes(bear, length_mi, color = decade, size = tor_f_scale),\n                 alpha = 0.5, size = 0.5,\n                 show.legend = TRUE) +\n  scale_x_continuous(breaks = c(0, 90, 180, 270),\n                     labels = c(\"0°\", \"90°\", \"180°\", \"270°\")) +\n  scale_y_continuous(trans = \"log10\") +\n  scale_color_viridis_d(end = 0.85,\n                       direction = 1) +\n  coord_polar(theta = \"x\") +\n  theme(panel.border = element_blank(),\n        axis.line = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.98, 0.25)\n        ) +\n  guides(color = guide_legend(override.aes = list(size = 3))) +\n  labs(\n    title = \"Bearings of NC tornado segment tracks\",\n    subtitle = \"By track length and decade. 1970-01-01 to 2023-04-30\",\n    x = NULL,\n    y = \"length_mi (log10 scale)\",\n    color = NULL,\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.3: Bearings of NC tornado segments, track length, and decade\n\n\n\n\n\nHistograms make this pattern clearer:\n\n\nShow the code\nhalf_width <- 9.5\n\ndata_for_plot <- dta |>\n  st_drop_geometry() |>\n  filter(!is.na(bear),\n         !is.null(bear)) |>\n  mutate(length_mi = log2(as.numeric(length_mi)),  # rescaling for better plot\n         # sin/cos swapped b/c Bearing is clockwise from top per https://stackoverflow.com/questions/70014534/r-create-vector-graph-with-bearing-and-distance\n         bin = floor(bear / 20) * 20,\n         bin = if_else(bin < 0, bin + 360, bin)\n         ) |>\n  count(bin, decade) |>\n  mutate(x = n * sin(bin * pi / 180),\n         y = n * cos(bin * pi / 180)\n         )\n\nmax_x = 1.1 * max(data_for_plot$x, na.rm = TRUE)\nmax_y = 1.1 * max(data_for_plot$y, na.rm = TRUE)\n\ndata_for_breaks <- tribble(\n  ~x,       ~y,     ~bearing,\n  0,        max_y,  \"0°\",\n  max_x,    0,      \"90°\",\n  0,        -max_y, \"180°\",\n  -max_x,   0,      \"270°\",\n)\n\ndata_for_origins <- data_for_plot |>\n  distinct(decade) |>\n  mutate(x = 0,\n         y = 0)\n  \ndata_for_plot |>\n  ggplot() +\n  geom_segment(data = data_for_breaks,\n               aes(x = 0, xend = 0.8 * x, y = 0, yend = 0.8 * y),\n               alpha = 0.4, linewidth = 0.15) +\n  geom_text(data = data_for_breaks,\n             aes(x, y, label = bearing),\n            size = 3) +\n  geom_segment(aes(x = 0, y = 0, xend = x, yend = y, color = decade, ),\n                 alpha = 0.75, linewidth = 1,\n                 show.legend = FALSE) +\n  geom_point(data = data_for_origins,\n             aes(x, y),\n             size = 0.5) +\n  scale_y_continuous(breaks = c(20, 40, 60)) + \n  scale_x_continuous(breaks = NULL) +\n  scale_color_viridis_d(end = 0.85,\n                       direction = 1) +\n  coord_fixed(clip = \"off\") +\n\n  facet_wrap(~decade) +\n  theme(panel.border = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\")\n        ) +\n  labs(\n    title = \"Bearing histograms of NC tornado segment tracks\",\n    subtitle = \"1970-01-01 to 2023-04-30\",\n    x = NULL,\n    y = \"Number of tornado segments\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.4: Bearing histograms of NC tornado segment tracks by decade"
  },
  {
    "objectID": "tornadoes.html#tornado-event-track-length",
    "href": "tornadoes.html#tornado-event-track-length",
    "title": "1  Tornadoes",
    "section": "1.3 Tornado event track length",
    "text": "1.3 Tornado event track length\nStorm Event Database records for each tornado segment include start and end coordinates and the length of the segment (tor_length). In addition I calculated the segment lengths from the coordinates (length_mi). There are many more short tornado tracks than long ones. The two methods provide similar results: only a few differ in length by more than the length of the segment (ratio difference > 1 in panel C).\n\n\nShow the code\np1 <- dta |>\n  st_drop_geometry() |>\n  select(event_id, episode_id, tor_length, length_mi, year, decade) |>\n  ggplot() +\n  geom_histogram(aes(tor_length, fill = decade), binwidth = 2, \n                 alpha = 0.8,\n                 show.legend = FALSE) +\n  scale_fill_viridis_d(end = 0.85) +\n  theme(panel.border = element_blank(),\n        panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.65, 0.7)\n        ) +\n  labs(\n    subtitle = \"As recorded (`tor_length`)\",\n    x = \"Miles\",\n    y = \"Count\",\n    tag = \"A\"\n  )\n\np2 <- dta |>\n  st_drop_geometry() |>\n  select(event_id, episode_id, tor_length, length_mi, year, decade) |>\n  mutate(length_mi = drop_units(length_mi)) |>\n  ggplot() +\n  geom_histogram(aes(length_mi, fill = decade), binwidth = 2, \n                 alpha = 0.8,\n                 show.legend = TRUE) +\n  scale_fill_viridis_d(end = 0.85) +\n  theme(panel.border = element_blank(),\n        panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.65, 0.7)\n        ) +\n  labs(\n    subtitle = \"As calculated (`length_mi`)\",\n    x = \"Miles\",\n    y = NULL,\n    tag = \"B\"\n  )\n\np3 <- dta |>\n  st_drop_geometry() |>\n  select(event_id, episode_id, tor_length, length_mi, year, decade) |>\n  mutate(length_mi = drop_units(length_mi),\n         length_delta = abs(tor_length - length_mi),\n         ratio = if_else(length_mi > 0,\n                             abs(tor_length / length_mi - 1),\n                             0)\n         ) |>\n  pivot_longer(cols = c(length_delta, ratio),\n               names_to = \"difference_measure\",\n               values_to = \"value\") |>\n  ggplot() +\n  stat_ecdf(aes(value, color = difference_measure),\n            alpha = 0.8,\n            pad = FALSE,\n            show.legend = TRUE) +\n  scale_color_viridis_d(end = 0.85) +\n  scale_y_continuous(labels = label_percent()) +\n  coord_cartesian(xlim = c(NA, 3)) +\n  theme(panel.border = element_blank(),\n        panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.75, 0.2)\n        ) +\n  labs(\n    subtitle = \"ECDF: Difference in length abs(tor_length - length_mi)\\nand  ratio abs(tor_length / length_mi - 1)\",\n    x = \"Difference\",\n    y = \"Proportion of segments\",\n    color = \"Difference\\nmeasure\",\n    tag = \"C\"\n  )\n\np1 + p2 + p3 +\n  plot_annotation(title = \"NC tornado segment track length\",\n                  caption = my_caption,\n                  theme = theme(plot.title = element_text(size = rel(2.0), face = \"bold\"))\n  )\n\n\n\n\n\nFigure 1.5: Histograms of NC tornado segment tracks length\n\n\n\n\n\nMost differences occurred in the early and middle decades.\n\n\nShow the code\np1 <- dta |>\n  st_drop_geometry() |>\n  select(event_id, episode_id, tor_length, length_mi, year, decade) |>\n  mutate(length_mi = drop_units(length_mi),\n         length_delta = abs(tor_length - length_mi),\n         ratio = if_else(length_mi > 0,\n                             tor_length / length_mi,\n                             0)\n         ) |>\n  ggplot() +\n  stat_ecdf(aes(length_delta, color = decade),\n            alpha = 0.8,\n            pad = FALSE,\n            show.legend = FALSE) +\n  scale_color_viridis_d(end = 0.85) +\n  scale_y_continuous(labels = label_percent()) +\n  coord_cartesian(xlim = c(NA, 5)) +\n  theme(panel.border = element_blank(),\n        panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.75, 0.2)\n        ) +\n  guides(color = guide_legend(override.aes = list(linewidth = 3))) +\n  labs(\n    subtitle = \"ECDF: Difference in length: abs(tor_length - length_mi)\",\n    x = \"Difference (mi)\",\n    y = \"Proportion of segments\",\n    color = \"Decade\",\n    tag = \"A\"\n  )\n\np2 <- dta |>\n  st_drop_geometry() |>\n  select(event_id, episode_id, tor_length, length_mi, year, decade) |>\n  mutate(length_mi = drop_units(length_mi),\n         length_delta = abs(tor_length - length_mi),\n         ratio = if_else(length_mi > 0,\n                             abs(tor_length / length_mi - 1),\n                             0)\n         ) |>\n  ggplot() +\n  stat_ecdf(aes(ratio, color = decade),\n            alpha = 0.8,\n            pad = FALSE,\n            show.legend = TRUE) +\n  scale_color_viridis_d(end = 0.85) +\n  scale_y_continuous(labels = label_percent()) +\n  #coord_cartesian(xlim = c(NA, 3)) +\n  theme(panel.border = element_blank(),\n        panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.75, 0.2)\n        ) +\n  guides(color = guide_legend(override.aes = list(linewidth = 3))) +\n  labs(\n    subtitle = \"ECDF: Difference in ratio: abs(tor_length / length_mi - 1)\",\n    x = \"Difference\",\n    y = NULL,\n    color = \"Decade\",\n    tag = \"B\"\n  )\n\np1 + p2 +\n  plot_annotation(title = \"NC tornado segment track measurement differences\",\n                  caption = my_caption,\n                  theme = theme(plot.title = element_text(size = rel(2.0), face = \"bold\"))\n  )\n\n\n\n\n\nFigure 1.6: Cumulative distribution of NC tornado segment length measurement differences"
  },
  {
    "objectID": "tornadoes.html#tornado-force",
    "href": "tornadoes.html#tornado-force",
    "title": "1  Tornadoes",
    "section": "1.4 Tornado force",
    "text": "1.4 Tornado force\nThe force of tornadoes are measured on the Enhanced Fujita Scale since 2007, and on the Fujita scale prior to that. From the documentation explaining the tor_f_scale data column1:\nEnhanced Fujita Scale describes the strength of the tornado based on \nthe amount and type of damage caused by the tornado. The F-scale of \ndamage will vary in the destruction area; therefore, the highest value \nof the F-scale is recorded for each event.\n\nEF0 – Light Damage (40 – 72 mph)\nEF1 – Moderate Damage (73 – 112 mph)\nEF2 – Significant damage (113 – 157 mph)\nEF3 – Severe Damage (158 – 206 mph)\nEF4 – Devastating Damage (207 – 260 mph)\nEF5 – Incredible Damage (261 – 318 mph)\n\nThere are many more weak tornadoes than very strong ones.\n\n\nShow the code\nggplot() +\n  geom_sf(data = nc_counties,\n          fill = NA, linewidth = 0.05) +\n  geom_sf(data = nc_cities,\n          fill = \"grey85\", color = NA) +\n  geom_sf(data = nc_state,\n          fill = NA, linewidth = 0.5,\n          color = \"grey\") +\n  geom_sf(data = dta |>\n            mutate(tor_f_scale = ordered(factor(tor_f_scale))),\n          aes(color = tor_f_scale)) +\n  scale_color_viridis_d(end = 0.85) +\n  theme(panel.background = element_blank(),\n        panel.border = element_blank(),\n        panel.grid = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.3, 0.3)) +\n  guides(color = guide_legend(override.aes = list(linewidth = 3))) +\n  labs(\n    title = \"Tornado tracks in North Carolina by force\\n1970-01-01 to 2023-04-30\",\n    caption = my_caption,\n    color = \"Force (EF starting in 2007)\"\n  )\n\n\n\n\n\nFigure 1.7: Tornado tracks in NC 1970-01-01 to 2023-04-30. Color is force.\n\n\n\n\n\nConsidering Figure 1.8:\n\nIt seems unlikely that 90% (all but two) of the force 4 tornadoes occurred in the 1980s. The EF scale became operational in 20072 and includes 28 defined damage indicators used to estimate wind speed, so perhaps earlier F4 tornadoes might be rated lower on the EF scale if they occurred today.\nThere was a noticeable increase in F0 observations starting in the 1990s. For a closer look at this dynamic see Figure 4.1 and Figure 4.2.\n\n\n\nShow the code\np1 <- dta_non_mapping |>\n  mutate(decade = fct_rev(decade)) |>\n  ggplot(aes(tor_f_scale, fill = decade)) +\n  geom_histogram(binwidth = 1, \n                 alpha = 0.8,\n                 show.legend = FALSE) +\n  scale_fill_viridis_d(end = 0.85, direction = -1) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.02))) +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\")) +\n  \n  labs(\n    subtitle = \"Count - Decade by force\",\n    x = \"force\",\n    y = NULL,\n    fill = NULL\n  )\n\np2 <- dta_non_mapping |>\n  ggplot(aes(tor_f_scale, fill = decade)) +\n  geom_bar(position = position_fill(reverse = TRUE),\n           alpha = 0.8) +\n  scale_y_continuous(labels = label_percent(),\n                     expand = expansion(mult = c(0, 0))) +\n  scale_fill_viridis_d(end = 0.85, guide = guide_legend(reverse = TRUE)) +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\")) +\n  labs(\n    subtitle = \"Proportion - Decade by force\",\n    x = \"force\",\n    y = NULL,\n    fill = NULL\n  )\n\np3 <- dta_non_mapping |>\n  mutate(tor_f_scale = fct_rev(factor(tor_f_scale))) |>\n  count(tor_f_scale, decade) |>\n  ggplot(aes(decade, n, fill = tor_f_scale)) +\n  geom_col(alpha = 0.8,\n           show.legend = FALSE) +\n  scale_fill_viridis_d(end = 0.85, direction = -1,\n                       guide = guide_legend(reverse = FALSE)) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.02))) +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\")) +\n  labs(\n    subtitle = \"Count - Force by decade\",\n    x = NULL,\n    y = NULL,\n    fill = \"Force\"\n  )\n\np4 <- dta_non_mapping |>\n  ggplot(aes(decade, fill = factor(tor_f_scale))) +\n  geom_bar(position = position_fill(reverse = TRUE),\n           alpha = 0.8) +\n  scale_y_continuous(labels = label_percent(),\n                     expand = expansion(mult = c(0, 0))) +\n  scale_fill_viridis_d(end = 0.85, guide = guide_legend(reverse = TRUE)) +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = rel(4.0), face = \"bold\")) +\n  labs(\n    subtitle = \"Proportion - Force by decade\",\n    x = NULL,\n    y = NULL,\n    fill = \"Force\"\n  )\n\n(p1 + p2) / (p3 + p4) +\n  plot_annotation(\n    title = \"NC tornado force (EF scale starting in 2007)\",\n    subtitle = \"1970-01-01 to 2023-04-30\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.8: NC tornado force by decade and decade by force 1970-01-01 to 2023-04-30\n\n\n\n\n\nAre the more powerful tornadoes associated with hurricanes or hurricane remnants? Unfortunately the full data set doesn’t include enough information to answer that question, however in 2007+ the answer is “definitely not.” See Section 5.2.1, specifically Figure 5.1 and Figure 5.2."
  },
  {
    "objectID": "tornadoes.html#tornado-width-and-force",
    "href": "tornadoes.html#tornado-width-and-force",
    "title": "1  Tornadoes",
    "section": "1.5 Tornado width and force",
    "text": "1.5 Tornado width and force\nThere is an associations between reported tornado width and force. Considering only tornado events with width > 1 ft and nonzero track lengh, the simple linear model tor_width ~ tor_f_scale (mod1) explains about 30% of the variance. Note that Figure 1.9 shows a non-linear relationship. Mod2 log10(tor_width) ~ tor_f_scale explains 38%.\n\n\nShow the code\ndta_for_modeling_width <- dta |>\n  select(year, tor_f_scale, tor_width, tor_length, length_mi, decade) |>\n  filter(!is.na(tor_width),\n         !is.na(tor_length),\n         tor_length > 0, # not zero miles long\n         tor_width > 1) #|> #at least 1 ft wide\n  # mutate(tor_f_scale = scale(tor_f_scale, center = FALSE),\n  #        tor_width = scale(tor_width, center = FALSE),\n  #        tor_length = scale(tor_length, center = FALSE)\n  # )\n\n\nmod1 <- lm(tor_width ~ tor_f_scale,\n           data = dta_for_modeling_width)\n\nmod1_tidy <- mod1 |>\n  tidy() |>\n  mutate(model_id = \"mod1\",\n         model_formula = \"tor_width ~ tor_f_scale\") |>\n  bind_cols(glance(mod1)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n\nmod2 <- lm(log(tor_width) ~ tor_f_scale,\n           data = dta_for_modeling_width)\n\nmod2_tidy <- mod2 |>\n  tidy() |>\n  mutate(model_id = \"mod2\",\n         model_formula = \"log(tor_width) ~ tor_f_scale\") |>\n  bind_cols(glance(mod2)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n\nbind_rows(\n  mod1_tidy,\n  mod2_tidy\n  ) |>\n  filter(term != \"(Intercept)\") |>\n  gt() |>\n  fmt_number(columns = c(estimate, std.error, adj.r.squared, sigma),\n             decimals = 3)\n\n\n\n\n\n\n  \n    \n    \n      model_id\n      model_formula\n      term\n      estimate\n      std.error\n      adj.r.squared\n      sigma\n      nobs\n    \n  \n  \n    mod1\ntor_width ~ tor_f_scale\ntor_f_scale\n145.342\n6.662\n0.304\n208.845\n1088\n    mod2\nlog(tor_width) ~ tor_f_scale\ntor_f_scale\n0.714\n0.028\n0.379\n0.869\n1088\n  \n  \n  \n\n\n\n\n\n\n\nShow the code\ndta_for_modeling_width |>\n  filter(tor_width > 1) |>\n  ggplot(aes(tor_f_scale, tor_width)) +\n  geom_jitter(aes(color = decade), size = 0.5, alpha = 0.6, height = 0) +\n  geom_smooth(method = 'loess', formula = 'y ~ x', se = TRUE, span = 0.95) +\n  #scale_y_continuous(expand = expansion(mult = c(0, 0.02))) +\n  scale_y_log10() +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\")) +\n  guides(color = guide_legend(override.aes = list(size = 3))) +\n  labs(\n    title = glue(\"Tornado width by force\"),\n    subtitle = glue(\"This is an exponential relationship, since the nearly strait trend line\", \n                    \"\\noccurs with the Y axis is on the log scale\", \n                    \"\\nJitter used to spread out the force values on the plot\",\n                    \"\\nExcluding a handful of tracks recorded with width < 1 ft\"),\n    x = \"Tornado force\",\n    y = \"Tornado width (ft) log10 scale\",\n    color = NULL,\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.9: Reported tornado width by Enhanced Fujita scale"
  },
  {
    "objectID": "tornadoes.html#segment-boundaries-and-intersections",
    "href": "tornadoes.html#segment-boundaries-and-intersections",
    "title": "1  Tornadoes",
    "section": "1.6 Segment boundaries and intersections",
    "text": "1.6 Segment boundaries and intersections\nIn the NWS records, intersections of segments typically occur at county boundaries, since a new county triggers a new segment record. Others occur when tracks (typically from different years) cross; in these cases they are true intersections (and unusually unlucky spots).\n\n\nShow the code\n# find the intersecting geometries (lines in this case) and points of intersections\ndta_intersections <- st_intersection(dta, \n                                     dta |> select(geometry))\n\nggplot() +\n  geom_sf(data = nc_counties,\n          fill = NA, linewidth = 0.05) +\n  geom_sf(data = nc_cities,\n          fill = \"grey85\", color = NA) +\n  geom_sf(data = nc_state,\n          fill = NA, linewidth = 0.5,\n          color = \"grey\") +\n  geom_sf(data = dta_intersections,\n          aes(color = year),\n          linewidth = 0.5, alpha = 0.4) +\n  scale_color_viridis_c(end = 0.85) +\n  theme(panel.background = element_blank(),\n        panel.border = element_blank(),\n        panel.grid = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = \"right\") +\n  guides(color = guide_legend(override.aes = list(linewidth = 3))) +\n  labs(\n    title = \"Tornado segment track intersections\",\n    subtitle = glue(\"Points indicate intersections of tornado segment tracks\", \n                    \"\\nWhere tracks appear continuous, a point indicates the start of different segment of the same tornado.\",\n                    \" They mostly occur at county boundaries.\",\n                    \"\\nWhere tracks cross (and typically the line colors differ indicating different years), it's a true intersection\",\n                    \" (and an unusually unlucky spot)\"),\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 1.10: Tornado event track intersections"
  },
  {
    "objectID": "tornadoes.html#event-and-episode-narratives",
    "href": "tornadoes.html#event-and-episode-narratives",
    "title": "1  Tornadoes",
    "section": "1.7 Event and episode narratives",
    "text": "1.7 Event and episode narratives\nStarting consistently in 2007 the data set includes event and episode narratives. They transform abstract data into stories about places and (one step removed) the people in those places. Below are ten random examples:\n\n\nShow the code\ndta |>\n  st_drop_geometry() |>\n  filter(year(begin_datetime) > 2006) |>\n  sample_n(size = 10) |>\n  mutate(begin_date = as.Date(begin_datetime),\n         begin_location = str_to_title(begin_location),\n         county = str_to_title(cz_name_str),\n         county = str_remove(county, \"Co[.]\"),\n         begin_location = paste0(begin_location, \",\\n\", county),\n         ev_ep_id = paste0(event_id, \",\\n\", episode_id),\n         ) |>\n  select(ev_ep_id, begin_date, begin_location, event_narrative, episode_narrative) |>\n  arrange(desc(begin_date)) |>\n  gt()\n\n\n\n\n\n\n  \n    \n    \n      ev_ep_id\n      begin_date\n      begin_location\n      event_narrative\n      episode_narrative\n    \n  \n  \n    951724,\n156769\n2021-03-18\nWhitsett,\nGuilford \nAn EF-1 tornado touched down near I-85/40 near the Alamance-Guilford County line, then tracked northeastward and into Alamance County. Numerous trees and power lines were reported down as a result, along with multiple homes with roofs blown off.\nA mid level trough approached central North Carolina from the west and moved across the area during the afternoon and evening. This helped spark a round of late day showers and thunderstorms, some of which produced severe weather across the central Piedmont along a cold air damming surface boundary. Several tornadic storms occurred along and north of Interstate 85 during the late afternoon hours along the aforementioned boundary.\n    916388,\n151183\n2020-08-03\nPiney Grove,\nBrunswick \nWeak tornado impacted a small area near Law Road  SE and Old Ocean Highway East near the Brunswick  County Government Complex.  The tornado mainly  caused damage to trees and lifted after crossing  Old Ocean Highway East.\nHurricane Isaias came off the African coast as a tropical wave on July 23, 2020. It became Tropical Storm Isaias on July 30th, further strengthening to a hurricane on the 31st. After crossing the Bahamas, it weakened to a tropical storm. Isaias strengthened again to a hurricane as it approached the coast of North Carolina. Hurricane Isaias made landfall at Ocean Isle Beach as a strong Category 1 around 11 pm on August 3rd, with an 87 mph recorded gust. It pushed inland to Goldsboro NC, where it weakened and accelerated northward.   The hurricane spawned six tornadoes, ranging from EF-0 to EF-2. Most of the tornadoes occurred in Brunswick County.  Rainfall was heaviest along the coast of Georgetown County, topping out at nearly seven inches. Most areas along the coast of North and South Carolina received around three to four inches on average, with lesser amounts inland. The Wilmington ASOS reported a gust to 74 mph. Storm surge was significant in Brunswick County, where many docks were damage, and homes and businesses were inundated with three feet of water.  Downtown Wilmington also received a record surge that came up the Cape Fear River. Over 80,000 residences lost power in New Hanover county, with widespread outages along the coast of Pender County, as they were in the eastern eyewall. Total damage was at least 300 million dollars.\n    784850,\n130719\n2018-09-16\nSouth Wilmington,\nNew Hanover \nAn EF-0 tornado, with winds estimated at 75 mph touched down along Split Rail Dr.  Several large limps were torn from the tops of about a dozen pine trees, some falling onto a pickup truck.\nHurricane Florence began its long Atlantic trek from the Cape Verde Islands in early September. It made landfall near Wrightsville Beach during the morning of September 14th. The barometric pressure at landfall was 959 millibars, or 28.32 inches.The strongest winds were recorded at 106 mph at Cape Lookout, as well as 105 mph measured at the Wilmington International Airport.  In addition to the strong storm surge, there was historic rainfall totals of 20 to 25 inches, with isolated totals of 35 inches in parts of Bladen and Robeson counties. Flash Flooding was severe and widespread, with many communities experiencing flooding for the first time. River flooding was epic, with dozens of main highways impassible. Significant flooding occurred for weeks after the storm had departed.  The hurricane spawned 19 tornadoes, one causing significant damage to 8 structures in the Sydney community in Columbus county. The community at Lake Waccamaw experienced more damage than Hurricane Floyd in 1999, the previous benchmark for the area. In Pender County, over 6000 structures had damage, with 2800 structures suffered major damage or were destroyed altogether. Damage estimates from wind and water are in the tens of billions of dollars, making it one of the costliest hurricanes ever.\n    784840,\n130719\n2018-09-15\nWrightsboro,\nNew Hanover \nA tornado touched down briefly along Blue Clay Road north of I-140 and west of North College Road. Several hardwood trees up to ten inches in diameter were snapped off approximately 15 feet off the ground.\nHurricane Florence began its long Atlantic trek from the Cape Verde Islands in early September. It made landfall near Wrightsville Beach during the morning of September 14th. The barometric pressure at landfall was 959 millibars, or 28.32 inches.The strongest winds were recorded at 106 mph at Cape Lookout, as well as 105 mph measured at the Wilmington International Airport.  In addition to the strong storm surge, there was historic rainfall totals of 20 to 25 inches, with isolated totals of 35 inches in parts of Bladen and Robeson counties. Flash Flooding was severe and widespread, with many communities experiencing flooding for the first time. River flooding was epic, with dozens of main highways impassible. Significant flooding occurred for weeks after the storm had departed.  The hurricane spawned 19 tornadoes, one causing significant damage to 8 structures in the Sydney community in Columbus county. The community at Lake Waccamaw experienced more damage than Hurricane Floyd in 1999, the previous benchmark for the area. In Pender County, over 6000 structures had damage, with 2800 structures suffered major damage or were destroyed altogether. Damage estimates from wind and water are in the tens of billions of dollars, making it one of the costliest hurricanes ever.\n    620759,\n102653\n2016-02-24\nDexter,\nVance \nThe National Weather Service has confirmed that a tornado touched down in eastern Granville County and continued into western Vance County. Once the tornado crossed into Vance County, it continued for another 2.5 miles. The total path length was approximately 5 miles.  The damage along this path consisted of several stands of softwood trees snapped and blown down, several outbuildings blown down and/or destroyed, several cars and storage trailers uplifted and carried up to 50 yards away, and seven homes that were damaged, including one that was destroyed (roof and two exterior walls blown away). The degree of damage along most of the path suggested 95 to 110 mph wind speeds (EF-1), with a small segment of the path having more intense damage which suggested top wind speeds of 125 mph (EF-2).\nA few rounds of thunderstorms moved through Central North Carolina in association with a strong low pressure system moving northeastward from the Lower Mississippi River Valley into the Tennessee Valley and Ohio Valley. The resultant highly sheared environment over the coastal plain early in the day and increasing instability across Central North Carolina during the afternoon resulted in numerous severe thunderstorms and a few tornadoes.\n    292059,\n49724\n2011-04-28\nPungo,\nBeaufort \nTornado produced sporadic damage to trees along Candyfield Road and Pike Road. One large hard wood tree was snapped at the base.\nA strong cold front approached eastern North Carolina during the afternoon and evening of April 28th. Scattered thunderstorms developed in the warm and unstable air ahead of the front during the afternoon. Some of these storms became severe and produced large hail, damaging winds and a few tornadoes.\n    264039,\n45476\n2010-10-27\nBrooksdale,\nPerson \nA supercell thunderstorm produced a short lived EF-1 tornado which produced significant damage to a double wide modular home along Apple Tree Lane near Allensville Road. The modular home was shifted up to 40 feet off of its foundation and sustained significant structural damage, with 50 percent of the roof destroyed. One individual was inside the modular home at the time of the tornado and was not injured. Nearby modular homes sustained minor damage to the roof and siding. Numerous trees were either snapped off or uprooted at this location. Winds were estimated to be between 86 to 90 mph. The tornado then tracked eastward and across a wooded area before crossing Ruff Davis Road, where several trees were snapped off and downed in different directions. The tornado lifted as it moved into another wooded area east of Ruff Davis Road.\nTwo supercell thunderstorms developed along a slow moving cold front in a high shear, low CAPE environment along the southern periphery of a strong upper vortex over the northern Great Lakes. These supercells produced 5 weak tornadoes across Person, Orange, Granville and Vance counties during the afternoon and evening.\n    264113,\n45504\n2010-10-26\nQuaker Gap,\nStokes \nThe tornado touched down on Mountain View Church Road. It then tracked northeast increasing in strength and reaching its maximum strength and width at Flat Shoals Road. As the tornado continued to move northeast it dissipated as it passed Sizemore Road. The tornado produced a wide swath of tree damage, with the tops of many pine trees snapped off. There was some minor structural damage as well, with the roofs of a few barns blown off and thrown a couple hundred feet. A car port also collapsed crushing a car. Damage amounts are estimated.\nA strong low pressure system over Minnesota pushed a front across our area. Very strong winds aloft set the stage for damaging wind gusts and tornadoes. Enough instability was present ahead of this front to enhance the severe threat. An area of severe thunderstorms and embedded supercells moved into the Piedmont and foothills of North Carolina late in the evening of the 26th into early on the 27th. These storms produced areas of wind damage, one downburst, and one tornado. The front stalled over the area during the day of the 27th. Another piece of upper level energy moving along the front sparked more thunderstorms and embedded supercells late in the day on the 27th. These storms produced more wind damage, one more downburst, and one additional tornado.\n    134980,\n23128\n2008-11-15\nClement,\nSampson \nNumerous trees uprooted and snapped along the path of the storm. The most significant damage was concentrated at a home along Maxwell Road where trees were snapped in half and a carport was blown down and twisted into trees.\nTwo mini-supercells tracked northeast along a warm front during the early morning hours of the 15th. The two supercells spawned several tornadoes in Samspon, Johnston, and Wilson counties, two of which resulted in two fatalities.\n    103315,\n17824\n2008-05-09\nNewsome Store,\nHertford \nTornado tracked into Hertford county from Bertie county. Roofs were blown off of two homes, and numerous trees were downed. The tornado then tracked into Chowan county.\nScattered severe thunderstorms in advance of a cold front produced damaging winds and two tornadoes across portions of northeast North Carolina."
  },
  {
    "objectID": "property-damage.html#most-property-damage",
    "href": "property-damage.html#most-property-damage",
    "title": "2  Property damage",
    "section": "2.1 Most property damage",
    "text": "2.1 Most property damage\n\n\nShow the code\nggplot() +\n  geom_sf(data = nc_counties,\n          fill = NA, linewidth = 0.05) +\n  geom_sf(data = nc_cities,\n          fill = \"grey85\", color = NA) +\n  geom_sf(data = nc_state,\n          fill = NA, linewidth = 0.5,\n          color = \"grey\") +\n  geom_sf(data = dta |>\n            slice_max(damage_property_mil_2022, n = 10),\n          aes(color = damage_property_mil_2022)) +\n  #scale_color_continuous(trans = \"log2\") +\n  scale_color_gradient2(low = muted(\"blue\"),\n                        high = muted(\"red\"),\n                        trans = \"log2\") +\n  # scale_color_viridis_c(end = 0.85,\n  #                       trans = \"log2\") +\n  theme(panel.background = element_blank(),\n        panel.border = element_blank(),\n        panel.grid = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.3, 0.3)) +\n  labs(\n    title = glue(\"Top tornadoes causing ten largest amounts of estimated property damage\", \n                 \"\\nin North Carolina 1970-01-01 to 2023-04-30\"),\n    subtitle = \"In millions of 2022 dollars\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 2.1: Top tornadoes causing ten largest amounts of estimated property damage in NC 1970-01-01 to 2023-04-30.\n\n\n\n\n\n\n\nShow the code\ndata_for_modeling_with_cities |>\n  st_drop_geometry() |>\n  slice_max(damage_property_mil_2022, n = 10) |>\n  select(damage_property_mil_2022, n_intersects, length_mi, year, tor_f_scale, injuries_direct, injuries_indirect, \n         deaths_direct, deaths_indirect) |>\n  mutate(length_mi = drop_units(length_mi)) |>\n  arrange(desc(damage_property_mil_2022)) |>\n  gt() |>\n  tab_header(md(glue(\"**Top tornadoes causing ten largest amounts of estimated property damage in NC since {year_start}**\"))) |>\n  fmt_number(columns = damage_property_mil_2022,\n             decimals = 3) |>\n  fmt_number(columns = length_mi,\n             decimals = 1) |>\n  tab_source_note(md(\"*Data: NOAA Storm Events Database; analysis: Daniel Moul<br>damage_property_mil in millions of 2022 dollars*\"))\n\n\n\n\n\n\n  \n    \n      Top tornadoes causing ten largest amounts of estimated property damage in NC since 1971\n    \n    \n    \n      damage_property_mil_2022\n      n_intersects\n      length_mi\n      year\n      tor_f_scale\n      injuries_direct\n      injuries_indirect\n      deaths_direct\n      deaths_indirect\n    \n  \n  \n    61.855\n2\n18.2\n1988\n4\n105\n0\n2\n0\n    18.549\n1\n21.0\n2014\n3\n16\n0\n0\n1\n    14.967\n4\n38.0\n2011\n3\n67\n0\n4\n0\n    14.843\n1\n19.7\n1974\n4\n26\n0\n4\n0\n    13.015\n1\n26.2\n2011\n3\n85\n0\n1\n0\n    8.979\n1\n0.0\n1998\n3\n5\n0\n0\n0\n    7.577\n1\n15.1\n2018\n2\n0\n2\n0\n1\n    7.418\n1\n19.1\n2011\n3\n36\n0\n2\n0\n    7.043\n0\n4.8\n1984\n3\n0\n0\n0\n0\n    7.043\n0\n13.3\n1984\n3\n11\n0\n2\n0\n    7.043\n0\n27.5\n1984\n3\n90\n0\n10\n0\n    7.043\n0\n7.1\n1984\n4\n50\n0\n0\n0\n    7.043\n0\n6.6\n1984\n4\n40\n0\n0\n0\n    7.043\n0\n6.2\n1984\n3\n74\n0\n0\n0\n    7.043\n1\n4.5\n1984\n3\n7\n0\n0\n0\n    7.043\n1\n10.1\n1984\n4\n59\n0\n3\n0\n    7.043\n0\n6.6\n1984\n4\n0\n0\n0\n0\n    7.043\n0\n13.2\n1984\n4\n0\n0\n7\n0\n    7.043\n1\n3.2\n1984\n2\n2\n0\n0\n0\n    7.043\n1\n5.4\n1984\n2\n5\n0\n0\n0\n    7.043\n2\n21.0\n1984\n4\n153\n0\n9\n0\n  \n  \n    \n      Data: NOAA Storm Events Database; analysis: Daniel Mouldamage_property_mil in millions of 2022 dollars\n    \n  \n  \n\n\n\n\n\n\n\nShow the code\ndata_for_modeling_with_cities |>\n  st_drop_geometry() |>\n  slice_max(length_mi, n = 10) |>\n  select(length_mi, damage_property_mil, n_intersects, year, tor_f_scale, injuries_direct, injuries_indirect, \n         deaths_direct, deaths_indirect) |>\n  mutate(length_mi = drop_units(length_mi)) |>\n  arrange(desc(damage_property_mil)) |>\n  gt() |>\n  tab_header(md(glue(\"**Ten longest tornadoes tracks and related property damage in NC since {year_start}**\"))) |>\n  fmt_number(columns = damage_property_mil,\n             decimals = 3) |>\n  fmt_number(columns = length_mi,\n             decimals = 1) |>\n  tab_source_note(md(\"*Data: NOAA Storm Events Database; analysis: Daniel Moul<br>damage_property_mil in millions of dollars; not adjusted for inflation*\"))\n\n\n\n\n\n\n  \n    \n      Ten longest tornadoes tracks and related property damage in NC since 1971\n    \n    \n    \n      length_mi\n      damage_property_mil\n      n_intersects\n      year\n      tor_f_scale\n      injuries_direct\n      injuries_indirect\n      deaths_direct\n      deaths_indirect\n    \n  \n  \n    38.0\n11.500\n4\n2011\n3\n67\n0\n4\n0\n    30.3\n0.250\n2\n1992\n3\n12\n0\n0\n0\n    29.0\n0.250\n2\n1991\n2\n0\n0\n0\n0\n    28.1\n0.250\n1\n1984\n4\n280\n0\n2\n0\n    64.0\n0.025\n2\n1971\n1\n0\n0\n0\n0\n    44.2\n0.025\n1\n1971\n2\n0\n0\n0\n0\n    31.6\n0.025\n0\n1992\n3\n0\n0\n0\n0\n    31.5\n0.025\n4\n1973\n1\n0\n0\n0\n0\n    30.9\n0.025\n2\n1975\n2\n1\n0\n0\n0\n    69.6\n0.000\n1\n1971\n3\n0\n0\n0\n0\n  \n  \n    \n      Data: NOAA Storm Events Database; analysis: Daniel Mouldamage_property_mil in millions of dollars; not adjusted for inflation"
  },
  {
    "objectID": "property-damage.html#variable-associations-with-property-damage",
    "href": "property-damage.html#variable-associations-with-property-damage",
    "title": "2  Property damage",
    "section": "2.2 Variable associations with property damage",
    "text": "2.2 Variable associations with property damage\nThe models below explain between 10% and 15% of the variance–a surprisingly low amount. I’m using nominal dollars (not adjusted for inflation), since the model results are a little better than when using constant dollars.\n\n\nShow the code\ndata_for_modeling <- data_for_modeling_with_cities |>\n  st_drop_geometry()\n\nmod1 <- lm(damage_property_mil ~ tor_f_scale,\n           data = data_for_modeling)\n\nmod1_tidy <- mod1 |>\n  tidy() |>\n  mutate(model_id = \"mod1\",\n         model_formula = \"damage_property_mil ~ tor_f_scale\") |>\n  bind_cols(glance(mod1)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n  \nmod2 <- lm(damage_property_mil ~ length_mi,\n           data = data_for_modeling) # note: rows with NA length_mi are omitted\n\nmod2_tidy <- mod2 |>\n  tidy() |>\n  mutate(model_id = \"mod2\",\n         model_formula = \"damage_property_mil ~ length_mi\") |>\n  bind_cols(glance(mod2)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n\nmod3 <- lm(damage_property_mil ~ tor_f_scale + length_mi,\n           data = data_for_modeling)\n\nmod3_tidy <- mod3 |>\n  tidy() |>\n  mutate(model_id = \"mod3\",\n         model_formula = \"damage_property_mil ~ tor_f_scale + length_mi\") |>\n  bind_cols(glance(mod3)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n\nmod4 <- lm(damage_property_mil ~ n_intersects + tor_f_scale,\n           data = data_for_modeling_with_cities)\n\nmod4_tidy <- mod4 |>\n  tidy() |>\n  mutate(model_id = \"mod4\",\n         model_formula = \"damage_property_mil ~ n_intersects + tor_f_scale\") |>\n  bind_cols(glance(mod4)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n\nmodel_table <- bind_rows(\n  mod1_tidy,\n  mod2_tidy,\n  mod3_tidy,\n  mod4_tidy\n) |>\n  filter(term != \"(Intercept)\")\n\nmodel_table |>\n  gt() |>\n  fmt_number(columns = c(estimate, std.error, adj.r.squared, sigma),\n             decimals = 3)\n\n\n\n\n\n\n  \n    \n    \n      model_id\n      model_formula\n      term\n      estimate\n      std.error\n      adj.r.squared\n      sigma\n      nobs\n    \n  \n  \n    mod1\ndamage_property_mil ~ tor_f_scale\ntor_f_scale\n0.349\n0.027\n0.103\n0.918\n1428\n    mod2\ndamage_property_mil ~ length_mi\nlength_mi\n0.054\n0.005\n0.082\n1.057\n1097\n    mod3\ndamage_property_mil ~ tor_f_scale + length_mi\ntor_f_scale\n0.301\n0.038\n0.132\n1.028\n1097\n    mod3\ndamage_property_mil ~ tor_f_scale + length_mi\nlength_mi\n0.030\n0.006\n0.132\n1.028\n1097\n    mod4\ndamage_property_mil ~ n_intersects + tor_f_scale\nn_intersects\n0.229\n0.048\n0.131\n1.028\n1097\n    mod4\ndamage_property_mil ~ n_intersects + tor_f_scale\ntor_f_scale\n0.365\n0.033\n0.131\n1.028\n1097\n  \n  \n  \n\n\n\n\n\nIn the models above, if a term changes by \\(1\\), it results in an estimate change in the property damage in millions of dollars (nominial dollars–not adjusted for inflation).\nAdjusted \\(R^2\\) is the proportion of the variance explained by the linear regression.\n\nmod1: there is not much correlation between property damage and force of the tornado.\nmod2: there is not much correlation between property damage and the length of the tornado track.\nmod3: there is not much correlation between property damage and both force and length of track.\nmod4:including the number of intersections with populated areas does not improve the model materially. This is a surprise, since it seems to me the property damage would be higher the more times the tornado passes over a populated area."
  },
  {
    "objectID": "property-damage.html#property-damage-per-year",
    "href": "property-damage.html#property-damage-per-year",
    "title": "2  Property damage",
    "section": "2.3 Property damage per year",
    "text": "2.3 Property damage per year\nFirst a short digression: nominal dollars (not adjusted for inflation) over 50 years paints a distorted picture. Figure 2.2 presents the difference in perspective.\n\n\nShow the code\nyearly_property_damage <- dta_non_mapping |>\n  st_drop_geometry() |>\n  reframe(damage_property_mil = sum(damage_property_mil),\n          damage_property_mil_2022 = sum(damage_property_mil_2022),\n          n_tornadoes = n(),\n          .by = year) |>\n  mutate(damage_prop_mil_per_tornado = damage_property_mil / n_tornadoes,\n         damage_prop_mil_2022_per_tornado = damage_property_mil_2022 / n_tornadoes,\n         decade = as.factor(paste0(floor(year / 10) * 10, \"s\")))\n\nscale_y_max <- max(yearly_property_damage$damage_prop_mil_2022_per_tornado, na.rm = TRUE)\nscale_y_min <- min(yearly_property_damage$damage_prop_mil_2022_per_tornado, na.rm = TRUE)\n\np1 <- yearly_property_damage |>\n  ggplot(aes(n_tornadoes, damage_prop_mil_per_tornado, color = decade)) +\n  geom_point(show.legend = FALSE) +\n  scale_x_continuous() + #expand = expansion(mult = c(0.01, 0.02))) +\n  scale_y_log10(labels = label_number(prefix = \"$\", suffix = \"M\"),\n                     expand = expansion(mult = c(0.01, 0.02))) +\n  scale_color_viridis_d(end = 0.85) +\n  coord_cartesian(ylim = c(0.65 * scale_y_min, 1.05 * scale_y_max)) + \n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = \"right\") +\n  guides(color = guide_legend(override.aes = list(size = 3))) +\n  labs(\n    subtitle = \"Dollar amounts not adjusted for inflation\",\n    x = NULL,\n    x = \"Number of tornadoes recorded in year\",\n    y = \"Property damage per tornado in year (log10 scale)\",\n    color = NULL,\n  )\n\np2 <- yearly_property_damage |>\n  ggplot(aes(n_tornadoes, damage_prop_mil_2022_per_tornado, color = decade)) +\n  geom_point(show.legend = FALSE) +\n  scale_x_continuous() + #expand = expansion(mult = c(0.01, 0.02))) +\n  scale_y_log10(labels = label_number(prefix = \"$\", suffix = \"M\"),\n                     expand = expansion(mult = c(0.01, 0.02))) +\n  scale_color_viridis_d(end = 0.85) +\n  coord_cartesian(ylim = c(0.65 * scale_y_min, 1.05 * scale_y_max)) + \n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = \"right\") +\n  guides(color = guide_legend(override.aes = list(size = 3))) +\n  labs(\n    subtitle = \"Dollar amounts in 2022 dollars\",\n    x = \"Number of tornadoes recorded in year\",\n    y = NULL,\n    color = NULL,\n  )\n\np3 <- yearly_property_damage |>\n  ggplot() +\n  geom_segment(aes(x = n_tornadoes, xend = n_tornadoes, \n                   y = damage_prop_mil_per_tornado, yend = 0.95 * damage_prop_mil_2022_per_tornado, \n                   color = decade), \n               linewidth = 0.4, alpha = 0.4,\n               arrow = arrow(length = unit(1.5, \"mm\"),\n                             ends = \"last\",\n                             type = \"closed\"),\n               show.legend = FALSE) +\n  #geom_point(aes(x = n_tornadoes, y = damage_prop_mil_per_tornado, color = decade)) + \n  geom_point(aes(x = n_tornadoes, y = damage_prop_mil_2022_per_tornado, color = decade)) + \n  scale_x_continuous() + #expand = expansion(mult = c(0.01, 0.02))) +\n  scale_y_log10(labels = label_number(prefix = \"$\", suffix = \"M\"),\n                     expand = expansion(mult = c(0.01, 0.02))) +\n  scale_color_viridis_d(end = 0.85) +\n  coord_cartesian(ylim = c(0.65 * scale_y_min, 1.05 * scale_y_max)) + \n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = \"right\") +\n  guides(color = guide_legend(override.aes = list(size = 3,\n                                                  linewidth = 0))) +\n  labs(\n    subtitle = \"The difference it makes adjusting for inflation\",\n    x = \"Number of tornadoes recorded in year\",\n    y = NULL,\n    color = NULL,\n  )\n\np1 + p2 + p3 +\n  plot_annotation(\n    title = \"Estimated property damage per tornado each year\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 2.2: Property damage per tornado yearly\n\n\n\n\n\nBefore about 1996 it seems there were standard values used for property damage estimates, and even since then some values seem too common to be more than often-used estimates.\n\n\nShow the code\np1 <- dta_non_mapping |>\n  ggplot(aes(year, damage_property_mil, color = decade)) +\n  geom_jitter(size = 0.5, alpha = 0.6, show.legend = FALSE) +\n  scale_x_continuous(expand = expansion(mult = c(0.01, 0.02))) +\n  scale_y_log10(labels = label_number(prefix = \"$\", suffix = \"M\"),\n                     expand = expansion(mult = c(0.01, 0.02))) +\n  scale_color_viridis_d(end = 0.85) +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = \"right\") + #\n  guides(color = guide_legend(override.aes = list(size = 3))) +\n  labs(\n    subtitle = \"Dollar amounts not adjusted for inflation\",\n    x = NULL,\n    y = \"Property damage (log10 scale)\",\n    color = NULL\n  )\n\np2 <- dta_non_mapping |>\n  ggplot(aes(year, damage_property_mil_2022, color = decade)) +\n  geom_jitter(size = 0.5, alpha = 0.6) +\n  scale_x_continuous(expand = expansion(mult = c(0.01, 0.02))) +\n  scale_y_log10(labels = label_number(prefix = \"$\", suffix = \"M\"),\n                     expand = expansion(mult = c(0.01, 0.02))) +\n  scale_color_viridis_d(end = 0.85) +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = \"right\") + #\n  guides(color = guide_legend(override.aes = list(size = 3))) +\n  labs(\n    subtitle = \"In 2022 dollars\",\n    x = NULL,\n    y = NULL,\n    color = NULL\n  )\n\np1 + p2 +\n  plot_annotation(\n    title = \"Estimated property damage - each tornado\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 2.3: Property damage per tornado\n\n\n\n\n\n\n\nShow the code\nyearly_property_damage |>\n  select(-decade) |>\n  gt() |>\n  tab_header(md(glue(\"**Estimated yearly property damage in NC caused by tornadoes**\", \n                     \"<br>January 1, {year_start} to April 30, 2023\"))) |>\n  fmt_number(columns = c(damage_property_mil, damage_property_mil_2022, \n                         damage_prop_mil_per_tornado, damage_prop_mil_2022_per_tornado),\n             decimals = 3) |>\n  tab_source_note(md(\"*Data: NOAA Storm Events Database; analysis: Daniel Moul<br>damage_property_mil in millions of dollars*\"))\n\n\n\n\n\n\n  \n    \n      Estimated yearly property damage in NC caused by tornadoesJanuary 1, 1971 to April 30, 2023\n    \n    \n    \n      year\n      damage_property_mil\n      damage_property_mil_2022\n      n_tornadoes\n      damage_prop_mil_per_tornado\n      damage_prop_mil_2022_per_tornado\n    \n  \n  \n    1971\n0.325\n2.349\n5\n0.065\n0.470\n    1972\n0.253\n1.768\n4\n0.063\n0.442\n    1973\n0.431\n2.838\n41\n0.011\n0.069\n    1974\n2.928\n17.385\n23\n0.127\n0.756\n    1975\n0.666\n3.622\n38\n0.018\n0.095\n    1976\n0.494\n2.540\n23\n0.021\n0.110\n    1977\n0.336\n1.622\n31\n0.011\n0.052\n    1978\n0.156\n0.702\n15\n0.010\n0.047\n    1979\n0.113\n0.454\n12\n0.009\n0.038\n    1980\n0.083\n0.294\n14\n0.006\n0.021\n    1981\n0.728\n2.343\n12\n0.061\n0.195\n    1982\n0.093\n0.282\n13\n0.007\n0.022\n    1983\n0.710\n2.087\n16\n0.044\n0.130\n    1984\n35.160\n99.051\n35\n1.005\n2.830\n    1985\n0.306\n0.832\n8\n0.038\n0.104\n    1986\n0.138\n0.369\n17\n0.008\n0.022\n    1987\n0.302\n0.779\n4\n0.076\n0.195\n    1988\n29.006\n71.766\n24\n1.209\n2.990\n    1989\n16.710\n39.444\n26\n0.643\n1.517\n    1990\n0.166\n0.371\n18\n0.009\n0.021\n    1991\n1.136\n2.442\n29\n0.039\n0.084\n    1992\n1.087\n2.267\n41\n0.027\n0.055\n    1993\n0.666\n1.349\n11\n0.061\n0.123\n    1994\n0.222\n0.437\n13\n0.017\n0.034\n    1995\n1.434\n2.754\n26\n0.055\n0.106\n    1996\n0.887\n1.654\n57\n0.016\n0.029\n    1997\n0.088\n0.160\n11\n0.008\n0.015\n    1998\n9.269\n16.644\n66\n0.140\n0.252\n    1999\n1.367\n2.402\n38\n0.036\n0.063\n    2000\n0.092\n0.156\n24\n0.004\n0.006\n    2001\n0.032\n0.052\n13\n0.002\n0.004\n    2002\n0.307\n0.500\n11\n0.028\n0.045\n    2003\n0.306\n0.486\n36\n0.008\n0.014\n    2004\n0.342\n0.530\n70\n0.005\n0.008\n    2005\n0.295\n0.442\n23\n0.013\n0.019\n    2006\n0.227\n0.329\n31\n0.007\n0.011\n    2007\n0.027\n0.038\n14\n0.002\n0.003\n    2008\n2.246\n3.053\n65\n0.035\n0.047\n    2009\n0.321\n0.438\n34\n0.009\n0.013\n    2010\n2.449\n3.286\n28\n0.087\n0.117\n    2011\n41.165\n53.575\n82\n0.502\n0.653\n    2012\n1.955\n2.492\n24\n0.081\n0.104\n    2013\n0.690\n0.867\n10\n0.069\n0.087\n    2014\n15.745\n19.471\n37\n0.426\n0.526\n    2015\n0.023\n0.028\n9\n0.003\n0.003\n    2016\n0.231\n0.281\n17\n0.014\n0.017\n    2017\n4.033\n4.817\n41\n0.098\n0.117\n    2018\n6.916\n8.062\n38\n0.182\n0.212\n    2019\n0.870\n0.996\n51\n0.017\n0.020\n    2020\n0.980\n1.108\n50\n0.020\n0.022\n    2021\n0.218\n0.236\n21\n0.010\n0.011\n    2022\n0.354\n0.354\n21\n0.017\n0.017\n    2023\n0.001\n0.001\n7\n0.000\n0.000\n  \n  \n    \n      Data: NOAA Storm Events Database; analysis: Daniel Mouldamage_property_mil in millions of dollars"
  },
  {
    "objectID": "injury-death.html#injuries",
    "href": "injury-death.html#injuries",
    "title": "3  Injuries and deaths",
    "section": "3.1 Injuries",
    "text": "3.1 Injuries\n\n\nShow the code\nggplot() +\n  geom_sf(data = nc_counties,\n          fill = NA, linewidth = 0.05) +\n  geom_sf(data = nc_cities,\n          fill = \"grey85\", color = NA) +\n  geom_sf(data = nc_state,\n          fill = NA, linewidth = 0.5,\n          color = \"grey\") +\n  geom_sf(data = data_for_modeling_with_cities,\n          aes(color = injuries)) +\n  # scale_color_viridis_c(end = 0.85,\n  #                       trans = \"log2\") +\n  scale_color_gradient(low = carolina_blue,\n                       high = \"red\",\n                       trans = \"log2\",\n  ) +\n  theme(panel.background = element_blank(),\n        panel.border = element_blank(),\n        panel.grid = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.3, 0.3)) +\n  guides(color = guide_legend(override.aes = list(linewidth = 3),\n                              reverse = TRUE)) +\n  labs(\n    title = \"Tornado tracks in North Carolina colored by injuries\",\n    subtitle = \"Grey tracks indicate no recorded injuries. 1970-01-01 to 2023-04-30.\",\n    caption = my_caption,\n    color = \"Injuries\"\n  )\n\n\n\n\n\nFigure 3.2: Tornado tracks in NC 1970-01-01 to 2023-04-30. Color indicates number of recorded injuries (direct and indirect)\n\n\n\n\n\n\n\nShow the code\nggplot() +\n  geom_sf(data = nc_counties,\n          fill = NA, linewidth = 0.05) +\n  geom_sf(data = nc_cities,\n          fill = \"grey85\", color = NA) +\n  geom_sf(data = nc_state,\n          fill = NA, linewidth = 0.5,\n          color = \"grey\") +\n  geom_sf(data = data_for_modeling_with_cities |>\n            slice_max(injuries, n = 10),\n          aes(color = injuries)) +\n  # scale_color_continuous(trans = \"log2\") +\n  # scale_color_viridis_c(end = 0.85,\n  #                       trans = \"log2\") +\n  scale_color_gradient(low = carolina_blue,\n                       high = \"red\",\n                       trans = \"log2\",\n  ) +\n  theme(panel.background = element_blank(),\n        panel.border = element_blank(),\n        panel.grid = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.3, 0.3)) +\n  labs(\n    title = \"Tornadoes causing ten largest numbers of injuries in NC\",\n    subtitle = \"1970-01-01 to 2023-04-30\",\n    caption = my_caption,\n    color = \"Injuries\"\n  )\n\n\n\n\n\nFigure 3.3: Tornadoes causing ten largest number of injuries in NC (direct and indirect) 1970-01-01 to 2023-04-30.\n\n\n\n\n\n\n\nShow the code\ndata_for_modeling_with_cities |>\n  st_drop_geometry() |>\n  slice_max(injuries, n = 10) |>\n  select(injuries, year, event, episode, n_intersects, tor_f_scale, length_mi) |>\n  mutate(length_mi = drop_units(length_mi)) |>\n  arrange(desc(injuries)) |>\n  gt() |>\n  #tab_header(md(glue(\"**Tornadoes causing ten largest number of injuries in NC since {year_start}**\"))) |>\n  fmt_number(columns = length_mi,\n             decimals = 1) |>\n  sub_missing()\n\n\n\n\n\n\nTable 3.1:  Tornadoes causing ten largest number of injuries in NC since 1970 \n  \n    \n    \n      injuries\n      year\n      event\n      episode\n      n_intersects\n      tor_f_scale\n      length_mi\n    \n  \n  \n    280\n1984\nEvent ID 10088990: NA\nEpisode ID NA: NA\n1\n4\n28.1\n    153\n1984\nEvent ID 10089009: NA\nEpisode ID NA: NA\n2\n4\n21.0\n    120\n2011\nEvent ID 291729: Tornado spun up near Tarawa Terrace and quickly increased to EF2 intensity with winds to 125 mph and a damage width of 100 yards. Many residences were damaged severely. The tornado continued to track northeast and crossed Highway 24 and the Holiday City Subdivision at EF2 intensity with many homes severely damaged.  The tornado widened to about 450 yards as it crossed the Colonial Heights Subdivision with winds around 100 mph. The tornado narrowed to about 100 yards and increased to EF3 intensity with winds to 145 mph as it crossed Piney Green Road and impacted the Montclair Subdivision. Severe damage to many homes with some totally destroyed. Several vehicles were picked up and tossed. The tornado then appeared to weaken and lift as it moved northeast of Piney Green. Total damage was estimated at 9.4 million dollars. There were 30 injuries directly related to the tornado, 3 critical. No fatalities occurred.\nEpisode ID 49687: One of the largest tornado outbreaks ever observed across eastern North Carolina occurred during the afternoon and evening of April 16th 2011. Several powerful super-cell thunderstorms developed ahead of an approaching cold front. Conditions ahead of the front were favorable for tornadoes with a moderately unstable atmosphere combined with strong winds that veered with height. Altogether 12 tornadoes were reported across the Newport/Morehead City county warning area. These tornadoes combined to produce over 40 million dollars in damages. There were numerous injuries but no fatalities were reported. In addition to the tornadoes there were several reports of damaging winds and large hail.\n1\n3\n3.8\n    105\n1988\nEvent ID 10089411: NA\nEpisode ID NA: NA\n2\n4\n18.2\n    90\n1984\nEvent ID 10088994: NA\nEpisode ID NA: NA\n0\n3\n27.5\n    85\n2011\nEvent ID 297492: The tornado exited Hoke County and continued to move northeast crossing into Cumberland County, just north of NC Highway 401. EF0 damage continued near the Clifdale community, where the damage was more sporadic across Bones Creek and Stewarts Creek. Strong tornado damage then occurred in and near the Beaver Creek community along Reilly Road and Yadkin Road west of Fayetteville. Damage was mostly EF1 and EF2, but was briefly EF3 damage, with wind speeds near 140 mph, causing major damage to a business and some dwellings along Yadkin Road. EF0 and EF1 damage was then observed across Simmons Army Airfield, along Andrews Road and across from the Pine Forest High School. The Goodyear Plant on NC Highway 401 sustained minor damage as well. The tornado continued northeast through the Carlos and Slocomb communities, with mainly EF0 tree damage. Just south of the Linden community, a small area of EF2 damage occurred near McBryde Road where several homes were heavily damaged, including a mobile home that was completely destroyed. One fatality occurred when the tornado hit a double-wide mobile home.  The victim suffered massive head injuries. Two other occupants of the mobile home survived and were taken to Betsy Johnson Hospital. In total, approximately 1000 homes were damaged, of which 310 homes suffered major damage, with 287 homes being destroyed. There were also 40 businesses that experienced damage as well.\nEpisode ID 50288: A strong storm system that had a history of producing deadly tornadoes across Oklahoma and the deep south on the 14th and 15th weakened as it crossed the southern Appalachians during the early morning hours of the 16th.  A squall line descended the Blue Ridge by the late morning hours, and rapidly intensified  as it moved east into the central Piedmont of North Carolina, with four long live tornadic supercells evolving from the linear convective segment. These tornadic supercells went on to produce 9 tornadoes in the Raleigh CWA, including 2 EF3s, and 4 EF2s. The tornadoes left 8 dead with approximately 275 injuries.\n1\n3\n26.2\n    74\n1984\nEvent ID 10088998: NA\nEpisode ID NA: NA\n0\n3\n6.2\n    67\n2011\nEvent ID 297671: The tornado exited Chatham County and entered southwest Wake County as an EF0. There was multiple tree and roof damage along Avent Ferry Road, southwest of Holly Springs. The tornado intensified to an EF1 with winds of 86 mph as it reached Fire Station Number Two and the Holly Glenn Subdivision before crossing highway 55 and tracking through the Remington subdivision.  The tornado continued to track northeastward and caused extensive tree damage and damage to numerous homes, mainly from fallen trees along Pierce Olive, Ten-Ten, Penny Road, and Yates Mill Pond roads, as wind speeds increased to around 100 mph. The tornado crossed Tryon Road, between Lake Wheeler Road and the Raleigh Golf Association Golf Course, before tracking northeast across the entire City of Raleigh, producing EF1 damage in a narrow swath between 50 to 100 yards. It crossed directly over Interstates 40-440, between exits 297 and 298 with damage on both sides of the interstate clearly visible. The tornado continued northeast across South Saunders Street, where 4 businesses were damaged. A body shop was completely destroyed when the roof was ripped off and the side walls collapsed. The tornado continued to snap hardwood trees and power-lines near Mount Hope Cemetery and nearby homes. The tornado weakened as it moved northeast towards Shaw University. Campus dormitories and the university student center had windows blown in with roof damage. The tornado moved northeast along the east side of the major high rise buildings in downtown Raleigh, downing hundreds of trees, many of which fell on houses. The historic Oakwood to Lion`s Park sections of town, including the historic Oakwood Cemetery were hardest hit. Also in the path of the tornado was Saint Augustine`s College, which sustained roof damage to every building on campus. The tornado continued to down trees on numerous homes as it crossed North King Charles Road to Yonkers Road, producing EF1 damage to several businesses.  The tornado crossed the 440 beltline for a second time, this time on the northeast side of downtown Raleigh near the intersections of Westinghouse and Brentwood roads, again causing damages to several businesses, including the Raleigh Iceplex. The tornado then strengthened to an EF2 with winds greater than 110 mph as it continued northeast producing extensive tree damage in a 100 to 200 yard wide path from Stony Brook Drive to Buffalo Road. Snapped trees crashed onto and through numerous homes all along the path. Four fatalities occurred when a large tree fell onto a mobile home. Two other mobile homes were thrown 30 to 50 feet when the tie downs snapped from their anchor points with nearly all of the mobile homes in the Stony Brook mobile home park sustained some type of damage.  The EF2 tornado continued to move northeast across Buffalo Road, near the Cardinal Grove Subdivision. Several two story homes were completely destroyed with numerous other homes sustaining moderate to major damage. Damage consistent with an EF2 tornado continued with widespread damage in a 200 yard wide swath along Forestville road. A couple of mobile homes were destroyed and several two story homes suffered extensive roof damage, with continued numerous snapped trees falling on houses. The tornado weakened or lifted as it moved northeast towards Rolesville. Damage became very sporadic and isolated in nature as it neared the Franklin County line. In total, 2270 homes were damaged, including 67 homes that were destroyed, with another 184 homes experiencing major damage. There were also 34 businesses damaged.\nEpisode ID 50288: A strong storm system that had a history of producing deadly tornadoes across Oklahoma and the deep south on the 14th and 15th weakened as it crossed the southern Appalachians during the early morning hours of the 16th.  A squall line descended the Blue Ridge by the late morning hours, and rapidly intensified  as it moved east into the central Piedmont of North Carolina, with four long live tornadic supercells evolving from the linear convective segment. These tornadic supercells went on to produce 9 tornadoes in the Raleigh CWA, including 2 EF3s, and 4 EF2s. The tornadoes left 8 dead with approximately 275 injuries.\n4\n3\n38.0\n    67\n2011\nEvent ID 297554: The tornado exited Harnett County and continued northeast into southern Johnston County. The tornado track south of Benson, where it crossed NC Highway 242 and NC Highway 50. Several modular homes were destroyed, and numerous other homes sustained major damage. There was also hundreds of trees that were uprooted or snapped in half. The tornado subsequently crossed Interstate 40 near mile Marker 330 and continued moving northeast to just south of Four Oaks before crossing Interstate 95 near mile marker 90. The tornado lifted just before reaching Smithfield, where little or no damage was observed. Throughout this part of the track there was a broad swath of EF0 damage with embedded areas of EF1 and EF2 damage. In total, 450 homes were damaged, of which 287 homes were completely destroyed.\nEpisode ID 50288: A strong storm system that had a history of producing deadly tornadoes across Oklahoma and the deep south on the 14th and 15th weakened as it crossed the southern Appalachians during the early morning hours of the 16th.  A squall line descended the Blue Ridge by the late morning hours, and rapidly intensified  as it moved east into the central Piedmont of North Carolina, with four long live tornadic supercells evolving from the linear convective segment. These tornadic supercells went on to produce 9 tornadoes in the Raleigh CWA, including 2 EF3s, and 4 EF2s. The tornadoes left 8 dead with approximately 275 injuries.\n2\n2\n14.5\n    60\n1971\nEvent ID 10088066: NA\nEpisode ID NA: NA\n2\n3\n16.5\n    60\n2011\nEvent ID 291695: This is the second segment for the tornado that originally spun up in Lenoir County. The tornado moved into Greene county just west of Highway 903. The tornado produced mainly EF0 and EF1 damage across the southern part of Greene County with damage to trees and a few homes. The tornado intensified to EF3 with winds estimated up to 160 mph southwest of Snow Hill. The tornado continued at EF3 intensity as it crossed Highway 13 just west of Snow Hill. Numerous homes and businesses were severely damaged or destroyed in this area with some almost completely flattened. Numerous vehicles were also destroyed. The strong EF3 tornado continued as it moved north of Snow Hill and severely damaged the Greene County middle school where the roof was torn off. The tornado continued to produce EF3 damage as it moved along Albriton Road where large metal power poles were bent over or completely ripped out of the ground. The tornado finally began to weaken as it passed Taylor road and dissipated near Tysons Church Road. In all about 30 million dollars of damage occurred in Greene County. There were numerous injures, 2 serious. There were no fatalities.\nEpisode ID 49687: One of the largest tornado outbreaks ever observed across eastern North Carolina occurred during the afternoon and evening of April 16th 2011. Several powerful super-cell thunderstorms developed ahead of an approaching cold front. Conditions ahead of the front were favorable for tornadoes with a moderately unstable atmosphere combined with strong winds that veered with height. Altogether 12 tornadoes were reported across the Newport/Morehead City county warning area. These tornadoes combined to produce over 40 million dollars in damages. There were numerous injuries but no fatalities were reported. In addition to the tornadoes there were several reports of damaging winds and large hail.\n0\n3\n15.2"
  },
  {
    "objectID": "injury-death.html#variable-associations-with-injuries",
    "href": "injury-death.html#variable-associations-with-injuries",
    "title": "3  Injuries and deaths",
    "section": "3.2 Variable associations with injuries",
    "text": "3.2 Variable associations with injuries\nThe linear models below explain between 14% and 19% of the variance in number of injuries.\n\n\nShow the code\ndata_for_modeling <- data_for_modeling_with_cities |>\n  st_drop_geometry()\n\nmod1 <- lm(injuries ~ tor_f_scale,\n           data = data_for_modeling)\n\nmod1_tidy <- mod1 |>\n  tidy() |>\n  mutate(model_id = \"mod1\",\n         model_formula = \"injuries ~ tor_f_scale\") |>\n  bind_cols(glance(mod1)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n  \nmod2 <- lm(injuries ~ length_mi,\n           data = data_for_modeling) # note: rows with NA length_mi are omitted\n\nmod2_tidy <- mod2 |>\n  tidy() |>\n  mutate(model_id = \"mod2\",\n         model_formula = \"injuries ~ length_mi\") |>\n  bind_cols(glance(mod2)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n\nmod3 <- lm(injuries ~ tor_f_scale + length_mi,\n           data = data_for_modeling)\n\nmod3_tidy <- mod3 |>\n  tidy() |>\n  mutate(model_id = \"mod3\",\n         model_formula = \"injuries ~ tor_f_scale + length_mi\") |>\n  bind_cols(glance(mod3)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n\nmod4 <- lm(injuries ~ n_intersects + tor_f_scale,\n           data = data_for_modeling_with_cities)\n\nmod4_tidy <- mod4 |>\n  tidy() |>\n  mutate(model_id = \"mod4\",\n         model_formula = \"injuries ~ n_intersects + tor_f_scale\") |>\n  bind_cols(glance(mod4)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n\nmodel_table <- bind_rows(\n  mod1_tidy,\n  mod2_tidy,\n  mod3_tidy,\n  mod4_tidy\n) |>\n  filter(term != \"(Intercept)\")\n\nmodel_table |>\n  gt() |>\n  fmt_number(columns = c(estimate, std.error, adj.r.squared, sigma),\n             decimals = 3)\n\n\n\n\n\n\nTable 3.2:  Linear models: variables having associations with injuries \n  \n    \n    \n      model_id\n      model_formula\n      term\n      estimate\n      std.error\n      adj.r.squared\n      sigma\n      nobs\n    \n  \n  \n    mod1\ninjuries ~ tor_f_scale\ntor_f_scale\n5.139\n0.382\n0.141\n12.027\n1097\n    mod2\ninjuries ~ length_mi\nlength_mi\n0.717\n0.063\n0.106\n12.268\n1097\n    mod3\ninjuries ~ tor_f_scale + length_mi\ntor_f_scale\n3.876\n0.435\n0.166\n11.851\n1097\n    mod3\ninjuries ~ tor_f_scale + length_mi\nlength_mi\n0.406\n0.070\n0.166\n11.851\n1097\n    mod4\ninjuries ~ n_intersects + tor_f_scale\nn_intersects\n1.627\n0.564\n0.147\n11.987\n1097\n    mod4\ninjuries ~ n_intersects + tor_f_scale\ntor_f_scale\n4.940\n0.387\n0.147\n11.987\n1097\n  \n  \n  \n\n\n\n\n\n\nIn the models above, if a term changes by \\(1\\), it results in an estimate change in the number of injuries.\nAdjusted \\(R^2\\) is the proportion of the variance explained by the linear regression.\n\nmod1: there is not much correlation between injuries and force of the tornado.\nmod2: there is not much correlation between injuries and the length of the tornado track.\nmod3: there is not much correlation between injuries and both force and length of track.\nmod4: including the number of intersections with populated areas does not improve the model materially. This is a surprise, since it seems to me the number of injuries would be higher the more times the tornado passes over a populated area."
  },
  {
    "objectID": "injury-death.html#deaths",
    "href": "injury-death.html#deaths",
    "title": "3  Injuries and deaths",
    "section": "3.3 Deaths",
    "text": "3.3 Deaths\n\n\nShow the code\nggplot() +\n  geom_sf(data = nc_counties,\n          fill = NA, linewidth = 0.05) +\n  geom_sf(data = nc_cities,\n          fill = \"grey85\", color = NA) +\n  geom_sf(data = nc_state,\n          fill = NA, linewidth = 0.5,\n          color = \"grey\") +\n  geom_sf(data = data_for_modeling_with_cities,\n          aes(color = deaths)) +\n  # scale_color_viridis_c(end = 0.85,\n  #                       trans = \"log2\") +\n  scale_color_gradient(low = carolina_blue,\n                       high = \"red\",\n                       trans = \"log2\",\n  ) +\n  theme(panel.background = element_blank(),\n        panel.border = element_blank(),\n        panel.grid = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.3, 0.3)) +\n  guides(color = guide_legend(override.aes = list(linewidth = 3),\n                              reverse = TRUE)) +\n  labs(\n    title = \"Tornado tracks in North Carolina colored by deaths\",\n    subtitle = \"Grey tracks indicate no recorded deaths. 1970-01-01 to 2023-04-30.\",\n    caption = my_caption,\n    color = \"Deaths\"\n  )\n\n\n\n\n\nFigure 3.4: Tornado tracks in NC 1970-01-01 to 2023-04-30. Color indicates number of recorded deaths (direct and indirect)\n\n\n\n\n\n\n\nShow the code\nggplot() +\n  geom_sf(data = nc_counties,\n          fill = NA, linewidth = 0.05) +\n  geom_sf(data = nc_cities,\n          fill = \"grey85\", color = NA) +\n  geom_sf(data = nc_state,\n          fill = NA, linewidth = 0.5,\n          color = \"grey\") +\n  geom_sf(data = data_for_modeling_with_cities |>\n            slice_max(deaths, n = 10),\n          aes(color = deaths)) +\n  # scale_color_continuous(trans = \"log2\") +\n  # scale_color_viridis_c(end = 0.85,\n  #                       trans = \"log2\") +\n  scale_color_gradient(low = carolina_blue,\n                       high = \"red\",\n                       trans = \"log2\",\n  ) +\n  theme(panel.background = element_blank(),\n        panel.border = element_blank(),\n        panel.grid = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.3, 0.3)) +\n  guides(color = guide_legend(override.aes = list(linewidth = 3),\n                              reverse = TRUE)) +\n  labs(\n    title = \"Tornadoes causing ten largest numbers of deaths in NC\", \n    subtitle = \"1970-01-01 to 2023-04-30\",\n    caption = my_caption,\n    color = \"Deaths\"\n  )\n\n\n\n\n\nFigure 3.5: Tornadoes causing ten largest number of deaths in NC (direct and indirect) 1970-01-01 to 2023-04-30.\n\n\n\n\n\n\n\nShow the code\ndata_for_modeling_with_cities |>\n  st_drop_geometry() |>\n  slice_max(deaths, n = 10) |>\n  select(deaths, year, event, episode, n_intersects, tor_f_scale, length_mi) |>\n  mutate(length_mi = drop_units(length_mi)) |>\n  arrange(desc(deaths)) |>\n  gt() |>\n  #tab_header(md(glue(\"**Tornadoes causing ten largest number of deaths in NC since {year_start}**\"))) |>\n  fmt_number(columns = length_mi,\n             decimals = 1) |>\n  sub_missing()\n\n\n\n\n\n\nTable 3.3:  Tornadoes causing ten largest number of deaths in NC since 1970 \n  \n    \n    \n      deaths\n      year\n      event\n      episode\n      n_intersects\n      tor_f_scale\n      length_mi\n    \n  \n  \n    12\n2011\nEvent ID 304929: Tornado first touched down about one mile south of Askewville (east of U.S. Rt. 13), producing minor tree and building damage. The tornado began producing significant damage on the east side of Askewville, where numerous structures and several mobile homes sustained major damage or were destroyed. The tornado then tracked continuously for nearly 19 miles finally lifting east of Harrellsville. For much of the tornado's life, the path width was one half to nearly three quarters of a mile wide. EF2 and EF3 damage was widespread from just east of Askewville northeast to about 3 miles west of Colerain, then gradually decreased as the tornado crossed into Hertford county. Numerous homes were destroyed, and many others suffered varying degrees of damage. In addition, there was extensive damage to trees and wooded areas in the path of the tornado. A split in the tornado damage paths just north of Colerain suggests that the tornado underwent a cyclic re-development with 2 tornadoes on the ground simultaneously for a period of about 5 miles.\nEpisode ID 50952: Scattered severe thunderstorms in advance of a cold front produced damaging winds, large hail, and several tornadoes across portions of northeast North Carolina.\n0\n3\n14.3\n    10\n1984\nEvent ID 10088994: NA\nEpisode ID NA: NA\n0\n3\n27.5\n    9\n1984\nEvent ID 10089009: NA\nEpisode ID NA: NA\n2\n4\n21.0\n    8\n2006\nEvent ID 3485: Tornado touched down among manufactured homes just north of Old Lake Road and tracked across an area of more substantial homes and businesses along NC Highway 87. There were 13 homes (mobile and brick) destroyed and more than two dozen damaged. Damage was rated as F3 due to construction of structures that were damaged and destroyed - if structures were better constructed the damage may have been rated higher. The wind speed was estimated to be around 200 mph. As the tornado tracked north of NC Highway 87 toward the county line, the tree damage was rated as F1.\nEpisode ID 762: A fast moving tornadic thunderstorm moved ashore on the coast of Brunswick County. There was no damage found until the storm moved across extreme eastern Columbus County and then extreme western Pender County. The tornado produced F3 damage through Riegelwood and diminished to F1 intensity as it crossed a wooded area to the Cape Fear River and into Pender County.  This was the second deadliest tornado to hit North Carolina in the last 50 years.\n0\n3\n1.5\n    7\n1984\nEvent ID 10089004: NA\nEpisode ID NA: NA\n0\n4\n13.2\n    6\n1984\nEvent ID 10089003: NA\nEpisode ID NA: NA\n0\n3\n7.4\n    4\n1974\nEvent ID 10089850: NA\nEpisode ID NA: NA\n1\n4\n19.7\n    4\n1989\nEvent ID 10091699: NA\nEpisode ID NA: NA\n0\n4\n3.8\n    4\n2011\nEvent ID 297671: The tornado exited Chatham County and entered southwest Wake County as an EF0. There was multiple tree and roof damage along Avent Ferry Road, southwest of Holly Springs. The tornado intensified to an EF1 with winds of 86 mph as it reached Fire Station Number Two and the Holly Glenn Subdivision before crossing highway 55 and tracking through the Remington subdivision.  The tornado continued to track northeastward and caused extensive tree damage and damage to numerous homes, mainly from fallen trees along Pierce Olive, Ten-Ten, Penny Road, and Yates Mill Pond roads, as wind speeds increased to around 100 mph. The tornado crossed Tryon Road, between Lake Wheeler Road and the Raleigh Golf Association Golf Course, before tracking northeast across the entire City of Raleigh, producing EF1 damage in a narrow swath between 50 to 100 yards. It crossed directly over Interstates 40-440, between exits 297 and 298 with damage on both sides of the interstate clearly visible. The tornado continued northeast across South Saunders Street, where 4 businesses were damaged. A body shop was completely destroyed when the roof was ripped off and the side walls collapsed. The tornado continued to snap hardwood trees and power-lines near Mount Hope Cemetery and nearby homes. The tornado weakened as it moved northeast towards Shaw University. Campus dormitories and the university student center had windows blown in with roof damage. The tornado moved northeast along the east side of the major high rise buildings in downtown Raleigh, downing hundreds of trees, many of which fell on houses. The historic Oakwood to Lion`s Park sections of town, including the historic Oakwood Cemetery were hardest hit. Also in the path of the tornado was Saint Augustine`s College, which sustained roof damage to every building on campus. The tornado continued to down trees on numerous homes as it crossed North King Charles Road to Yonkers Road, producing EF1 damage to several businesses.  The tornado crossed the 440 beltline for a second time, this time on the northeast side of downtown Raleigh near the intersections of Westinghouse and Brentwood roads, again causing damages to several businesses, including the Raleigh Iceplex. The tornado then strengthened to an EF2 with winds greater than 110 mph as it continued northeast producing extensive tree damage in a 100 to 200 yard wide path from Stony Brook Drive to Buffalo Road. Snapped trees crashed onto and through numerous homes all along the path. Four fatalities occurred when a large tree fell onto a mobile home. Two other mobile homes were thrown 30 to 50 feet when the tie downs snapped from their anchor points with nearly all of the mobile homes in the Stony Brook mobile home park sustained some type of damage.  The EF2 tornado continued to move northeast across Buffalo Road, near the Cardinal Grove Subdivision. Several two story homes were completely destroyed with numerous other homes sustaining moderate to major damage. Damage consistent with an EF2 tornado continued with widespread damage in a 200 yard wide swath along Forestville road. A couple of mobile homes were destroyed and several two story homes suffered extensive roof damage, with continued numerous snapped trees falling on houses. The tornado weakened or lifted as it moved northeast towards Rolesville. Damage became very sporadic and isolated in nature as it neared the Franklin County line. In total, 2270 homes were damaged, including 67 homes that were destroyed, with another 184 homes experiencing major damage. There were also 34 businesses damaged.\nEpisode ID 50288: A strong storm system that had a history of producing deadly tornadoes across Oklahoma and the deep south on the 14th and 15th weakened as it crossed the southern Appalachians during the early morning hours of the 16th.  A squall line descended the Blue Ridge by the late morning hours, and rapidly intensified  as it moved east into the central Piedmont of North Carolina, with four long live tornadic supercells evolving from the linear convective segment. These tornadic supercells went on to produce 9 tornadoes in the Raleigh CWA, including 2 EF3s, and 4 EF2s. The tornadoes left 8 dead with approximately 275 injuries.\n4\n3\n38.0\n    3\n1976\nEvent ID 10089878: NA\nEpisode ID NA: NA\n0\n2\n10.2\n    3\n1984\nEvent ID 10089001: NA\nEpisode ID NA: NA\n1\n4\n10.1\n    3\n2004\nEvent ID 5418859: The remnants of Tropical Storm Bonnie produced a tornado that touched down just south of Rocky Point and moved northeast, causing F0-F2 damage.  Damage (F0) was first observed near West Strawberry Lane, with roof damage to a couple of structures.   The tornado crossed I-40, just southeast of Rocky Point.  It then tracked across Martin Marietta Access Road, causing f0-f1 tree damage.  The tornado intensified to f1-f2 as it moved into a small community along Hwy 210.  Significant damage occurred on Clayton Lane, Nixon Avenue, and Pickett Road.  The tornado reached peak intensity as it moved across Cart Wheel Road, where several homes were completely leveled.  It continued to track northeast, with F1 tree damage.  The tornado crossed the Northeast Cape Fear River and finally dissipated near Shaw Highway, approximately one mile north of Hwy 210.  The following is a summary of damage from Pender County Emergency Management.  \n\n     17 homes destroyed\n     25 other homes suffered major damage\n     34 other homes suffered minor damage\n     2 businesses suffered major damage\n     1 business suffered minor damage\nEpisode ID 1178556: NA\n0\n2\n5.4\n    3\n2011\nEvent ID 300477: A National Weather Service Storm Survey Team found evidence of a strong tornado in northern Bladen County, near Ammon, North Carolina. The damage was rated up to an EF2. The maximum wind speed was estimated up to 130 mph.  The path length was one and a half miles in Bladen County. However, the tornado remained on the ground as it moved into southeast Cumberland County. The maximum path width was 200 yards. The tornado first touched down southwest of Old Fayetteville Road and severely impacted Foxfire Nursery in northern Bladen County. The tornado completely destroyed four large hog houses and significantly damaged two others. More than one hundred hogs were killed by the tornado. Small offices and outbuildings near the hog houses were either completely destroyed or significantly damaged. There were a couple dozen trees downed in the area. Power lines were also downed.  The damage was rated EF1 with winds to 105 mph. The tornado moved across a wooded area and as it approached Old Fayetteville Road, it completely destroyed three manufactured homes, two singlewide trailers and a doublewide. A fourth singlewide manufactured home was broken from its foundation and turned 90 degrees on the north side of Old Fayetteville Road. All of the homes appeared to have been strapped down. There were three fatalities. Several dozen pine and hardwood trees were snapped off as were a few power poles. The damage near and along Old Fayetteville Road was rated EF2 with winds to 130 mph. The damage path then crossed into southeast Cumberland County (WFO Raleigh, North Carolina's County Warning Area).\nEpisode ID 50654: A powerful storm system that had moved across the deep south during previous days, swept across the eastern Carolinas during the afternoon and evening hours. Instability and shear values were highly supportive of super-cell thunderstorms. The result was a large outbreak of severe weather including strong and deadly tornadoes across eastern North Carolina.\n0\n2\n1.5\n    3\n2021\nEvent ID 945569: The tornado touched down near the intersection of Old Georgetown Road SW and Angel Trace Road as an EF-0, where a couple of pine trees were snapped and several large limbs were broken. It moved to the northeast across a forest, then rapidly intensified to an EF-2 as it approached Hwy 904. A large portion of a roof was blown off a metal building on the west side of 904, several RVs were rolled over, and several large pine trees were snapped. The tornado crossed Hwy 904, snapped numerous trees and caused moderate damage to a large metal building and church.  The tornado entered the Ocean Ridge Plantation neighborhood with wind speeds up to 125 mph. Hundreds of trees were snapped, and many homes sustained minor to moderate damage. It crossed Rosebury Court SW, then strengthened to its maximum intensity of 160 mph (EF-3), as it approached Cambria Court SW. Two homes were completely destroyed in this area, and several more sustained moderate to major damage. The tornado reached its maximum path width of 275 yards as it moved across Windsor Circle, although maximum winds decreased to 115 mph (EF2). Many homes sustained moderate to major damage, hundreds of large trees were snapped, and one automobile was observed rolled on its side.  It crossed Hwy 17 as an EF-1, then re-intensified to an EF-2, causing major damage to several homes and snapping hundreds of trees along Green Bay Road NW and Old Shallote Road NW. The tornado continued to produce a near continuous path of tree damage through forest and swamp land, across Hwy 130 and Highway 211, confirmed by helicopter overflight. The tornado lifted approximately three miles east of highway 211 after passing west of the Bear Pen Airstrip.\nEpisode ID 156532: Strong low pressure and a cold front produced an EF-3 tornado.\n2\n3\n21.9"
  },
  {
    "objectID": "injury-death.html#variable-associations-with-death",
    "href": "injury-death.html#variable-associations-with-death",
    "title": "3  Injuries and deaths",
    "section": "3.4 Variable associations with death",
    "text": "3.4 Variable associations with death\nThe linear models below explain between 10% and 14% of the variance in number of deaths.\n\n\nShow the code\ndata_for_modeling <- data_for_modeling_with_cities |>\n  st_drop_geometry()\n\nmod1 <- lm(deaths ~ tor_f_scale,\n           data = data_for_modeling)\n\nmod1_tidy <- mod1 |>\n  tidy() |>\n  mutate(model_id = \"mod1\",\n         model_formula = \"deaths ~ tor_f_scale\") |>\n  bind_cols(glance(mod1)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n  \nmod2 <- lm(deaths ~ length_mi,\n           data = data_for_modeling) # note: rows with NA length_mi are omitted\n\nmod2_tidy <- mod2 |>\n  tidy() |>\n  mutate(model_id = \"mod2\",\n         model_formula = \"deaths ~ length_mi\") |>\n  bind_cols(glance(mod2)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n\nmod3 <- lm(deaths ~ tor_f_scale + length_mi,\n           data = data_for_modeling)\n\nmod3_tidy <- mod3 |>\n  tidy() |>\n  mutate(model_id = \"mod3\",\n         model_formula = \"deaths ~ tor_f_scale + length_mi\") |>\n  bind_cols(glance(mod3)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n\nmod4 <- lm(deaths ~ n_intersects + tor_f_scale,\n           data = data_for_modeling_with_cities)\n\nmod4_tidy <- mod4 |>\n  tidy() |>\n  mutate(model_id = \"mod4\",\n         model_formula = \"deaths ~ n_intersects + tor_f_scale\") |>\n  bind_cols(glance(mod4)) |>\n  select(model_id, model_formula, term, estimate, std.error, adj.r.squared, sigma, nobs)\n\nmodel_table <- bind_rows(\n  mod1_tidy,\n  mod2_tidy,\n  mod3_tidy,\n  mod4_tidy\n) |>\n  filter(term != \"(Intercept)\")\n\nmodel_table |>\n  gt() |>\n  fmt_number(columns = c(estimate, std.error, adj.r.squared, sigma),\n             decimals = 3)\n\n\n\n\n\n\nTable 3.4:  Linear models: variables having associations with deaths \n  \n    \n    \n      model_id\n      model_formula\n      term\n      estimate\n      std.error\n      adj.r.squared\n      sigma\n      nobs\n    \n  \n  \n    mod1\ndeaths ~ tor_f_scale\ntor_f_scale\n0.271\n0.022\n0.116\n0.706\n1097\n    mod2\ndeaths ~ length_mi\nlength_mi\n0.033\n0.004\n0.067\n0.726\n1097\n    mod3\ndeaths ~ tor_f_scale + length_mi\ntor_f_scale\n0.224\n0.026\n0.126\n0.702\n1097\n    mod3\ndeaths ~ tor_f_scale + length_mi\nlength_mi\n0.015\n0.004\n0.126\n0.702\n1097\n    mod4\ndeaths ~ n_intersects + tor_f_scale\nn_intersects\n0.009\n0.033\n0.116\n0.707\n1097\n    mod4\ndeaths ~ n_intersects + tor_f_scale\ntor_f_scale\n0.270\n0.023\n0.116\n0.707\n1097\n  \n  \n  \n\n\n\n\n\n\nIn the models above, if a term changes by \\(1\\), it results in an estimate change in the number of deaths.\nAdjusted \\(R^2\\) is the proportion of the variance explained by the linear regression.\n\nmod1: there is not much correlation between deaths and force of the tornado.\nmod2: there is not much correlation between deaths and the length of the tornado track.\nmod3: there is not much correlation between deaths and both force and length of track.\nmod4: as with injuries, including the number of intersections with populated areas does not improve the model materially. This is a surprise, since it seems to me the number of deaths would be higher the more times the tornado passes over a populated area."
  },
  {
    "objectID": "data-generating-changes.html#sec-changes-detection-over-time",
    "href": "data-generating-changes.html#sec-changes-detection-over-time",
    "title": "4  Data generating changes",
    "section": "4.1 Changes in tornado detection over time",
    "text": "4.1 Changes in tornado detection over time\nThe plots below reveal that prior to 1997 weak tornadoes and ones with short tracks were mostly missed or the data was incomplete. I presume the improvements were are due to the introduction of more automated means of identifying and estimating the force of these less significant tornadoes, for example, directly from radar or satellite data with sensors providing higher resolution data, and NWS staff using more powerful computers and more sophisticated algorithms (which seem more likely than a change in the frequency of weak, short-lived tornadoes over this time period).\nFigure 4.1 provides evidence that the NWS offices started using better instruments. The reduction in missing coordinate data starting in 1996 is very impressive (panel A). So is the increase in the number of records of short-lived, weak tornadoes evident in panels B and C starting in the 2000s.\n\n\nShow the code\np1 <- dta_non_mapping |>\n  mutate(missing_data = is.na(begin_lat) | is.na(end_lat)) |> # if lat is missing, lon is missing too\n  summarize(n = n(),\n            n_missing = sum(missing_data),\n            n_not_missing = sum(!missing_data),\n            pct_missing = n_missing / n,\n            .by = year) |>\n  ggplot() +\n  geom_jitter(aes(year, pct_missing, size = n),\n              alpha = 0.6) + #size = 1, \n  scale_y_continuous(labels = label_percent(),\n                     expand = expansion(mult = c(0, 0.02))) +\n  theme(panel.grid = element_blank(),\n        legend.position = c(0.85, 0.6)) +\n  labs(\n    subtitle = glue(\"Percent incomplete records by year\",\n                    \"\\nMissing begin or end coordinates\"),\n    x = NULL,\n    tag = \"A\"\n  )\n\nx_ann <- 1975\ny_ann <- 0.95 * max(dta_for_datacheck$length_mi)\n\np2 <- dta_for_datacheck |>\n  ggplot() +\n  geom_jitter(aes(year, length_mi),\n              size = 0.5, alpha = 0.6) +\n  annotate(\"text\", x = x_ann, y = y_ann, \n           label = glue(\"Excludes {n_zero} tornadoes\", \n           \"\\nmissing coordinate data\",\n           \"\\nin the years before 2005\"),\n           hjust = 0, size = 3, fontface = 'italic') +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.02))) +\n  theme(panel.grid = element_blank(),\n        legend.position = c(0.7, 0.2)) +\n  labs(\n    subtitle = \"Track length by year: Coordinate data for more\\nshort tracks have been detected in recent years\",\n    x = NULL,\n    tag = \"B\"\n  )\n\np3 <- dta_non_mapping |>\n  ggplot() +\n  geom_jitter(aes(year, tor_f_scale),\n              size = 0.5, alpha = 0.6) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.02))) +\n  theme(panel.grid = element_blank(),\n        ) +\n  labs(\n    subtitle = \"Force by year: more weak tornadoes\\nhave been detected in recent years\",\n    x = NULL,\n    tag = \"C\"\n  )\n\np1 + p2 + p3 + \n  plot_annotation(\n    title = \"Changes in tornado detection over time in NC\",\n    caption = my_caption,\n    theme = theme(plot.title = element_text(size = rel(2.0), face = \"bold\"))\n  )\n\n\n\n\n\nFigure 4.1: Are there changes in detection over time?"
  },
  {
    "objectID": "data-generating-changes.html#track-length",
    "href": "data-generating-changes.html#track-length",
    "title": "4  Data generating changes",
    "section": "4.2 Track length",
    "text": "4.2 Track length\nThe differences in recorded and calculated track length have changed over time: a higher proportion of the differences are very small after about 2007 (with the exception of the 100% artifacts below).\nSome observations arising from Figure 4.2:\n\nPanel A: from about 1994 to 2007 it seems NWS staff commonly (but not exclusively) used round numbers when recording track length: \\([0.1, 0.2, 0.3, 0.4, 0.5, 1.0, 2.0, 3.0]\\)\nPanel B: records with non-zero recorded length but zero calculated length are plotted as 100% different. Why does this occur mainly between 1993 and 2007? Perhaps the NWE forecasting offices gained instruments that could better detect short tracks but not with great accuracy. Or perhaps they stopped sending people out to manually measure every event, instead relying on weather radars that did not allow sufficient accuracy in determining beginning and ending coordinates.\nPanel C: If the recorded track length matched the length I calculated using the coordinates were equal, all points would lay on the line.\n\nSee also Figure 1.6 NC tornado segment track measurement differences.\n\n\nShow the code\nn_5mi <- dta_for_datacheck |>\n  filter(length_diff > 5) |>\n  nrow()\n\nn_double <- dta_for_datacheck |>\n  filter(pct_diff > 2) |>\n  nrow()\n\nn_calc_zero <- dta_for_datacheck |>\n  filter(tor_length > 0 & length_mi < 1e-6) |>\n  nrow()\n  \np1 <- dta_for_datacheck |>\n  filter(length_diff <= 5) |>\n  ggplot() +\n  geom_jitter(aes(year, length_diff),\n              size = 0.5, alpha = 0.6) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.02))) +\n  theme(panel.grid = element_blank()) +\n  labs(\n    subtitle = glue(\"Excluding {n_5mi} events w/ calculated and reported\\nlength differing by more than 5 mi\"),\n    x = NULL,\n    y = \"Difference in miles\",\n    tag = \"A\"\n  )\n\np2 <- dta_for_datacheck |>\n  filter(pct_diff < 2) |>\n  ggplot() +\n  geom_jitter(aes(year, pct_diff),\n              size = 0.5, alpha = 0.6) +\n  scale_y_continuous(labels = label_percent(),\n                     expand = expansion(mult = c(0, 0.02))) +\n  theme(panel.grid = element_blank()) +\n  labs(\n    subtitle = glue(\"Excluding {n_double} events w/ calculated and reported\\nlength differing by more than 200%\",\n                    \"\\n{n_calc_zero} events have non-zero recorded length but\\nzero calculated length (shown as 100% diff)\"),\n    x = NULL,\n    y = \"Percent difference\",\n    tag = \"B\"\n  )\n\np3 <- dta_for_datacheck |>\n  filter(tor_length > 0,\n         length_mi > 0) |>\n  ggplot() +\n  geom_jitter(aes(tor_length, length_mi, color = decade),\n              size = 0.5, alpha = 0.6) +\n  scale_x_continuous(trans = \"log2\",\n                     expand = expansion(mult = c(0.01, 0.02))) +\n  scale_y_continuous(trans = \"log2\",\n                     labels = label_number(accuracy = 0.01)\n                     #expand = expansion(mult = c(0, 0.02))\n                     ) +\n  theme(panel.grid = element_blank(),\n        legend.position = c(0.8, 0.3)) +\n  guides(color = guide_legend(override.aes = list(size = 3))) +\n  \n  labs(\n    subtitle = glue(\"Calcuated length_mi by recorded tor_length (mi)\",\n                    \"\\nExcluding {n_zero} observations with zero length\"),\n    x = \"recorded length (log2 scale)\",\n    y = \"calculated length (log2 scale)\",\n    color = NULL,\n    tag = \"C\"\n  )\n  \np1 + p2 + p3 +\n  plot_annotation(\n    title = \"How closely do reported and calculated track length agree over time?\",\n    subtitle = \"The differences are smaller in recent years\",\n    caption = my_caption,\n    theme = theme(plot.title = element_text(size = rel(2.0), face = \"bold\"))\n  )\n\n\n\n\n\nFigure 4.2: Comparing reported and calculated tornado track length over time"
  },
  {
    "objectID": "data-generating-changes.html#track-length-error",
    "href": "data-generating-changes.html#track-length-error",
    "title": "4  Data generating changes",
    "section": "4.3 Track length error",
    "text": "4.3 Track length error\nThe improvement in measurement is visible in the reduction of error. Figure 4.3 plots root square error (RSE)1 on the X axis. The improvements are visible beginning in the 2000s both visually and in RMSE.\n\n\nShow the code\ndata_for_plot <- dta_for_datacheck |>\n  filter(tor_length > 0,\n         length_mi > 0) |>\n  mutate(rse = sqrt((tor_length - length_mi)^2),\n         rse_pct_of_tor_length = rse / tor_length) \n\nrmse_data <- data_for_plot |>\n  reframe(rmse = sqrt(mean((tor_length - length_mi)^2)),\n          x = min(rmse),\n          y = max(rse_pct_of_tor_length),\n            .by = decade)\n\ndata_for_plot |>\n  ggplot() +\n  geom_point(aes(rse, rse_pct_of_tor_length, color = decade),\n              size = 0.5, alpha = 0.6,\n             show.legend = FALSE) +\n  geom_text(data = rmse_data,\n            aes(x = 0.00005, y = 16, label = paste0(\"RMSE: \", round(rmse, digits = 2)), # min(x), y = max(y)\n                hjust = 0),\n            size = 3) +\n  scale_x_continuous(trans = \"log2\",\n                     #expand = expansion(mult = c(0.02, 0.02)),\n                     labels = label_number(accuracy = 0.0001)) +\n  scale_y_continuous(trans = \"log2\",\n                     #expand = expansion(mult = c(0.02, 0.02)),\n                     labels = label_number(accuracy = 0.0001)\n                     ) +\n  facet_wrap(~decade) +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.8, 0.3)) +\n  guides(color = guide_legend(override.aes = list(size = 3))) +\n  labs(\n    title = \"A reduction in error over time: RSE as percent of tor_length (mi)\\nby RSE of calculated length_mi\",\n    subtitle = glue(\"Excluding {n_zero} observations with zero length\"),\n    x = \"rse (log2 scale)\",\n    y = \"rse_pct_of_tor_length (log2 scale)\",\n    color = NULL\n  )\n\n\n\n\n\nFigure 4.3: Comparing track length error by decade: root square error as percent of tor_length (mi) by calculated length_mi"
  },
  {
    "objectID": "notes.html#sources-of-data",
    "href": "notes.html#sources-of-data",
    "title": "5  Notes",
    "section": "5.1 Sources of data",
    "text": "5.1 Sources of data\n\n5.1.1 Storm data\nData from Storm Events Database, NOAA National Centers for Environmental Information. Database: https://www.ncdc.noaa.gov/stormevents/ I used the “Search” option.\nDownloaded 2023-08-12, 2023-08-13 and 2023-10-15\nDocumentation: https://www1.ncdc.noaa.gov/pub/data/swdi/stormevents/csvfiles/Storm-Data-Export-Format.pdf and saved as “./data/Storm-Data-Export-Format.pdf”\nStorm Events Database\nEvent Types: Tornado\n\n52 events were reported between 01/01/1970 and 12/31/1973 (1461 days)\n410 events were reported between 01/01/1974 and 12/31/1993 (7305 days) \n295 events were reported between 01/01/1994 and 12/31/2003 (3652 days) \n381 events were reported between 01/01/2004 and 12/31/2013 (3653 days) \n292 events were reported between 01/01/2014 and 08/11/2023 (3510 days) \nData saved as\n\"./data/raw/tornados_1970-01-01_to_1973-12-31.csv\"\n\"./data/raw/tornados_1974-01-01_to_1993-12-31.csv\"\n\"./data/raw/tornados_1994-01-01_to_2003-12-31.csv\"\n\"./data/raw/tornados_2004-01-01_to_2013-12-31.csv\"\n\"./data/raw/tornados_2014-01-01_to_2023-04-30.csv>\nNote: on 2023-08-11 when I downloaded 2023 data, the database included records only through 2023-04-30.\nFrom the documentation explaining tor_f_scale:\nEnhanced Fujita Scale describes the strength of the tornado based on the amount and type of damage caused by the tornado. The F-scale of damage will vary in the destruction area; therefore, the highest value of the F-scale is recorded for each event.\nEF0 – Light Damage (40 – 72 mph)\nEF1 – Moderate Damage (73 – 112 mph)\nEF2 – Significant damage (113 – 157 mph)\nEF3 – Severe Damage (158 – 206 mph)\nEF4 – Devastating Damage (207 – 260 mph)\nEF5 – Incredible Damage (261 – 318 mph)\n\n\n5.1.2 City and town data\nCity and town data is from https://www.nconemap.gov/datasets/NCDOT::ncdot-city-boundaries/about\nI downloaded this data on 2022-09-25. From the readme:\n\nNCDOT City Boundaries This map service is provided by NC Department of Transportation and represents Municipal Boundaries defined through the Powell Bill 2020…. This data is updated annually; usually in February.\n\nI filtered the data to include cities and towns with at least 500 estimated residents in 2021.\n\n\n5.1.3 County boundaries\nDownloaded from US Census Bureau using the tigris package."
  },
  {
    "objectID": "notes.html#other-explorations",
    "href": "notes.html#other-explorations",
    "title": "5  Notes",
    "section": "5.2 Other explorations",
    "text": "5.2 Other explorations\n\n5.2.1 Tornado force and hurricanes\nAre the more powerful tornadoes associated with hurricanes or hurricane remnants? It would be possible to look at force value and whether “hurricane” is mentioned in the event or episode narrative. Unfortunately the data set doesn’t include enough information to answer that question. This is a biased subset, since narratives were not common before 2007. Supplemental hurricane data would be needed to answer this question.\n\n\nShow the code\ndta_non_mapping |>\n  mutate(narrative_exists  = !is.na(event_narrative) & !is.na(episode_narrative)) |>\n  count(year, narrative_exists) |>\n  mutate(pct_exists = n / sum(n),\n         .by = year) |>\n  ggplot() +\n  geom_col(aes(year, pct_exists, fill = narrative_exists)) +\n  scale_fill_viridis_d(end = 0.85) +\n  scale_y_continuous(labels = label_percent(),\n                     expand = expansion(mult = c(0, 0))) +\n  theme(panel.grid = element_blank()) +\n  labs(\n    title = glue(\"There aren't enough narratives available in the earlier years\",\n    \"\\nto draw any conclusions about the association of high force value\", \n    \"\\nand existence of a hurricane\"),\n    x = NULL,\n    y = \"Percent of hurricanes in NC\",\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 5.1: NC tornadoes with event and espisode narratives\n\n\n\n\n\n\n\nShow the code\ndata_for_plot <- dta_non_mapping |>\n  filter(year >= 2007) |>\n  mutate(hurricane_related  = ifelse(str_detect(event_narrative, \"urricane|remnant\") |\n                                       str_detect(episode_narrative, \"urricane|remnant\"),\n                                     \"Yes\",\n                                     \"No\")) |>\n  count(year, hurricane_related) |>\n  mutate(pct = n / sum(n),\n         .by = year)\n\nn_hurricane_related <- data_for_plot |>\n  filter(hurricane_related == \"Yes\") |>\n  pull(n) |>\n  sum()\n\npct_hurricane_related <- n_hurricane_related / sum(data_for_plot$n)\n\n\nConsidering tornadoes in 2007 and later (549 events):\n\n\nShow the code\np1 <- data_for_plot |>\n  ggplot() +\n  geom_col(aes(year, n, fill = hurricane_related)) +\n  scale_fill_viridis_d(end = 0.85) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +\n  theme(panel.grid = element_blank()) +\n  labs(\n    subtitle = glue(\"Count\"),\n    x = NULL,\n    y = NULL\n  )\n\np2 <- data_for_plot |>\n  ggplot() +\n  geom_col(aes(year, pct, fill = hurricane_related),\n           show.legend = FALSE) +\n  scale_fill_viridis_d(end = 0.85) +\n  scale_y_continuous(labels = label_percent(),\n                     expand = expansion(mult = c(0, 0))) +\n  theme(panel.grid = element_blank()) +\n  labs(\n    subtitle = glue(\"Proportion\"),\n    x = NULL,\n    y = NULL\n  )\n\np1 / p2 +\n  plot_annotation(\n    title = glue(\"Only {percent(pct_hurricane_related)} of tornadoes in NC since 2007 have an association with\",\n                 \"\\nmention of a 'hurricane' or 'remnant' in the event or episode narrative\", \n                 \"\\n('remnant' typically refers to a named hurricane or tropical storm)\"),\n    caption = my_caption\n  )\n\n\n\n\n\nFigure 5.2: A minority of tornadoes are associated with hurricane mentions in event or episode narratives\n\n\n\n\n\n\n\n5.2.2 Combining multi-county events of same episode\n\n\nShow the code\nd_episodes <- dta |>\n  arrange(begin_datetime) |>\n  group_by(episode_id) |>\n  summarize(injuries = sum(injuries_direct + injuries_indirect),\n            deaths = sum(deaths_direct + deaths_indirect)) %>%\n  st_cast(\"MULTILINESTRING\") |>\n  ungroup() |>\n  st_set_crs(\"NAD83\")\n\ndta_episodes <- left_join(\n  d_episodes,\n  dta |>\n    st_drop_geometry(),\n  by = \"episode_id\",\n  multiple = \"first\"\n)\n\nn_episodes <- nrow(dta_episodes)\n\n\nCombining the tracks that are part of the same episode reduces the number of tracks from 1,097 to 500. This is not an accurate count of the number of tornadoes, since one episode can spawn multiple distinct tornadoes.\n\n\nShow the code\nggplot() +\n  geom_sf(data = nc_counties,\n          fill = NA, linewidth = 0.05) +\n  geom_sf(data = nc_cities,\n          fill = \"grey85\", color = NA) +\n  geom_sf(data = nc_state,\n          fill = NA, linewidth = 0.5,\n          color = \"grey\") +\n  geom_sf(data = dta_episodes,\n          aes(color = injuries)) +\n  scale_linewidth(range = c(1, 3)) +\n  scale_color_viridis_c(end = 0.85,\n                        trans = \"log2\") +\n  theme(panel.background = element_blank(),\n        panel.border = element_blank(),\n        panel.grid = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.3, 0.3)) +\n  guides(color = guide_legend(override.aes = list(linewidth = 3),\n                              reverse = TRUE)) +\n  labs(\n    title = \"Tornado tracks in same episodes North Carolina colored by injuries\\n1974-01-01 to 2023-04-30\",\n    subtitle = glue(\"Grey tracks indicate no recorded injuries; {n_episodes} unique episodes\"),\n    caption = my_caption,\n    color = \"Injuries\"\n  )\n\n\n\n\n\nFigure 5.3: Tornado tracks in NC 1974-01-01 to 2023-04-30. Color indicates number of recorded injuries (direct and indirect)\n\n\n\n\n\n\n\nShow the code\nggplot() +\n  geom_sf(data = nc_counties,\n          fill = NA, linewidth = 0.05) +\n  geom_sf(data = nc_cities,\n          fill = \"grey85\", color = NA) +\n  geom_sf(data = nc_state,\n          fill = NA, linewidth = 0.5,\n          color = \"grey\") +\n  geom_sf(data = dta_episodes,\n          aes(color = deaths)) +\n  scale_linewidth(range = c(1, 3)) +\n  scale_color_viridis_c(end = 0.85,\n                        trans = \"log2\") +\n  theme(panel.background = element_blank(),\n        panel.border = element_blank(),\n        panel.grid = element_blank(),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        plot.title = element_text(size = rel(2.0), face = \"bold\"),\n        legend.position = c(0.3, 0.3)) +\n  guides(color = guide_legend(override.aes = list(linewidth = 3),\n                              reverse = TRUE)) +\n  labs(\n    title = \"Tornado tracks in same episodes in North Carolina colored by deaths\\n1974-01-01 to 2023-04-30\",\n    subtitle = glue(\"Grey tracks indicate no recorded deaths; {n_episodes} unique episodes\"),\n    caption = my_caption,\n    color = \"Deaths\"\n  )\n\n\n\n\n\nFigure 5.4: Tornado tracks in NC 1974-01-01 to 2023-04-30. Color indicates number of recorded deaths (direct and indirect)\n\n\n\n\n\nThe NWS’s method for counting tornadoes is summarized on Storm Data FAQ Page1\n\nTornadoes may contain multiple segments. A tornado that crosses a county line or state line is considered a separate segment. Also, a tornado that lifts off the ground for less than 4 minutes or 2 miles is considered a separate tornado segment. If the tornado lifts off the ground for greater than 4 minutes or 2 miles, it is considered a separate tornado. Tornadoes reported in Storm Data and the Storm Events Database are in segments. For official tornado counts by state, please use the monthly counts at the Storms Prediction Center Tornado Data.\n\nCan I reconstruct the number of tornadoes given the above definition and the data at hand? Not easily.\n\nI can calculate time_gap_min and prior_event_distance_mi for the events in one episode, however the hard part is in all cases to arrange the events in the correct order so that these calculations are with the right pairs of events.\nThe case I haven’t solved is when \\(T\\) tornadoes are recorded as starting at or around the same time: how to order them and the \\(\\{1..n\\}\\) subsequent “next segment” records \\((n \\le T)\\)?\n\nSince this question is unanswered (considering the amount of time I’m willing to invest), I will be clear that events are segments, not unique tornadoes and present the simple case, for example in the introduction and in Figure 1.10 Tornado segment track intersections."
  }
]